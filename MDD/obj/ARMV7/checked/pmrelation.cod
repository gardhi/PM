; Listing generated by Microsoft (R) Optimizing Compiler Version 17.00.50727.114 

	TTL	C:\wince800\platform\rrm_ppc_windows\src\drivers\pm\mdd\pmrelation.cpp
	THUMB

  00000			 AREA	 |.drectve|, DRECTVE
	DCB	"-defaultlib:LIBCMT "
	DCB	"-defaultlib:OLDNAMES "

	IMPORT	|__security_push_cookie|
	IMPORT	|__security_pop_cookie|
	IMPORT	|__GSHandlerCheck|
	IMPORT	|StringCchVPrintfW|
	IMPORT	|StringCchLengthW|
	IMPORT	|CeLogData|

  00000			 AREA	 |.pdata|, PDATA
|$pdata1$CeLogMsg| DCD imagerel |$LN8@CeLogMsg|
	DCD	imagerel |$unwind2$CeLogMsg|

  00000			 AREA	 |.xdata|, DATA
|$unwind2$CeLogMsg| DCD 0x44b00032
	DCD	0x1e889e8
	DCD	0x400a8fb
	DCD	0x8801e8ff
	DCD	0xff05ef00
	DCD	imagerel |__GSHandlerCheck|
	DCD	0xffffffe5
; Function compile flags: /Ogsp
; File c:\wince800\public\common\sdk\inc\celog.h

  00000			 AREA	 |.text|, CODE, THUMB

  00000		 |CeLogMsg| PROC

; 1208 : {

  00000		 |$LN8@CeLogMsg|
  00000	b40f		 push        {r0-r3}
  00002	e92d 4800	 push        {r11,lr}
  00006	46eb		 mov         r11,sp
  00008	f000 f800	 bl          __security_push_cookie
  0000c	f2ad 2d24	 subw        sp,sp,#0x224
  00010		 |$M6|
  00010	4602		 mov         r2,r0

; 1209 :     va_list arglist;
; 1210 :     WCHAR   szTemp[MAX_PATH];
; 1211 :     size_t  cchLen;
; 1212 :     HRESULT hr;
; 1213 : 
; 1214 :     // Compose a single string using the input args
; 1215 :     va_start(arglist, szFormat);
; 1216 :     hr = StringCchVPrintfW(szTemp, MAX_PATH, szFormat, arglist);

  00012	a806		 add         r0,sp,#0x18
  00014	ab8d		 add         r3,sp,#0x234
  00016	f44f 7182	 mov         r1,#0x104
  0001a	928c		 str         r2,[sp,#0x230]
  0001c	f000 f800	 bl          StringCchVPrintfW

; 1217 :     if (SUCCEEDED(hr)) {

  00020	2800		 cmp         r0,#0
  00022	db17		 blt         |$LN1@CeLogMsg|

; 1218 :         hr = StringCchLengthW(szTemp, MAX_PATH, &cchLen);

  00024	aa04		 add         r2,sp,#0x10
  00026	a806		 add         r0,sp,#0x18
  00028	f44f 7182	 mov         r1,#0x104
  0002c	f000 f800	 bl          StringCchLengthW

; 1219 :         if (SUCCEEDED(hr)) {

  00030	2800		 cmp         r0,#0
  00032	db0f		 blt         |$LN1@CeLogMsg|

; 1220 :             CeLogData(TRUE, CELID_RAW_WCHAR, szTemp, (WORD)((cchLen + 1) * sizeof(WCHAR)),
; 1221 :                       0, CELZONE_ALWAYSON, 0, FALSE);

  00034	f04f 4380	 mov         r3,#0x40000000
  00038	9301		 str         r3,[sp,#4]
  0003a	9b04		 ldr         r3,[sp,#0x10]
  0003c	2200		 movs        r2,#0
  0003e	9203		 str         r2,[sp,#0xC]
  00040	3301		 adds        r3,#1
  00042	005b		 lsls        r3,r3,#1
  00044	9202		 str         r2,[sp,#8]
  00046	9200		 str         r2,[sp]
  00048	aa06		 add         r2,sp,#0x18
  0004a	214a		 movs        r1,#0x4A
  0004c	b29b		 uxth        r3,r3
  0004e	2001		 movs        r0,#1
  00050	f000 f800	 bl          CeLogData
  00054		 |$LN1@CeLogMsg|
  00054		 |$M9|

; 1222 :         }
; 1223 :     }
; 1224 : }

  00054	f20d 2d24	 addw        sp,sp,#0x224
  00058	f000 f800	 bl          __security_pop_cookie
  0005c	f85d bb04	 pop         {r11}
  00060	f85d fb14	 ldr         pc,[sp],#0x14
  00064		 |$M7|

			 ENDP  ; |CeLogMsg|

	EXPORT	|??_C@_1CO@JNMCMHEL@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAl?$AAe?$AAa?$AAs?$AAi?$AAn?$AAg?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?$AN?$AA?6?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1DG@KMABPNDO@?$AAP?$AAm?$AAR?$AAe?$AAl?$AAe?$AAa?$AAs?$AAe?$AAP?$AAo?$AAw?$AAe?$AAr?$AAR?$AAe?$AAl?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AAh?$AAi?$AAp?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1FK@FNONLNGN@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAD?$AAE?$AAB?$AAU?$AAG?$AAC?$AAH?$AAK?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?5?$AAi?$AAn?$AA?5?$AAf?$AAi?$AAl?$AAe?$AA?5?$AA?$CF?$AAs?$AA?5?$AAa@| [ DATA ] ; `string'
	EXPORT	|??_C@_1IO@ENPFMAPK@?$AAc?$AA?3?$AA?2?$AAw?$AAi?$AAn?$AAc?$AAe?$AA8?$AA0?$AA0?$AA?2?$AAp?$AAl?$AAa?$AAt?$AAf?$AAo?$AAr?$AAm?$AA?2?$AAr?$AAr?$AAm?$AA_?$AAp?$AAp?$AAc?$AA_?$AAw?$AAi?$AAn@| [ DATA ] ; `string'
	EXPORT	|??_C@_1CG@EPNLEKEF@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AA?$CF?$AAd?$AA?$AN?$AA?6?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|PmReleasePowerRelationship|
	IMPORT	|dpCurSettings|
	IMPORT	|NKDbgPrintfW|
	IMPORT	|CheckDevicePointer|
	IMPORT	|RemoveDevice|
	IMPORT	|DeviceStateDecRef|

  00008			 AREA	 |.pdata|, PDATA
|$pdata1$PmReleasePowerRelationship| DCD imagerel |$LN16@PmReleaseP|
	DCD	0xfd32610d

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1CG@EPNLEKEF@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AA?$CF?$AAd?$AA?$AN?$AA?6?$AA?$AA@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "r", 0x0, "e", 0x0, "t"
	DCB	0x0, "u", 0x0, "r", 0x0, "n", 0x0, "i", 0x0, "n", 0x0, "g"
	DCB	0x0, " ", 0x0, "%", 0x0, "d", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0
	DCB	0x0					; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1IO@ENPFMAPK@?$AAc?$AA?3?$AA?2?$AAw?$AAi?$AAn?$AAc?$AAe?$AA8?$AA0?$AA0?$AA?2?$AAp?$AAl?$AAa?$AAt?$AAf?$AAo?$AAr?$AAm?$AA?2?$AAr?$AAr?$AAm?$AA_?$AAp?$AAp?$AAc?$AA_?$AAw?$AAi?$AAn@| DCB "c"
	DCB	0x0, ":", 0x0, "\\", 0x0, "w", 0x0, "i", 0x0, "n", 0x0, "c"
	DCB	0x0, "e", 0x0, "8", 0x0, "0", 0x0, "0", 0x0, "\\", 0x0, "p"
	DCB	0x0, "l", 0x0, "a", 0x0, "t", 0x0, "f", 0x0, "o", 0x0, "r"
	DCB	0x0, "m", 0x0, "\\", 0x0, "r", 0x0, "r", 0x0, "m", 0x0, "_"
	DCB	0x0, "p", 0x0, "p", 0x0, "c", 0x0, "_", 0x0, "w", 0x0, "i"
	DCB	0x0, "n", 0x0, "d", 0x0, "o", 0x0, "w", 0x0, "s", 0x0, "\\"
	DCB	0x0, "s", 0x0, "r", 0x0, "c", 0x0, "\\", 0x0, "d", 0x0, "r"
	DCB	0x0, "i", 0x0, "v", 0x0, "e", 0x0, "r", 0x0, "s", 0x0, "\\"
	DCB	0x0, "p", 0x0, "m", 0x0, "\\", 0x0, "m", 0x0, "d", 0x0, "d"
	DCB	0x0, "\\", 0x0, "p", 0x0, "m", 0x0, "r", 0x0, "e", 0x0, "l"
	DCB	0x0, "a", 0x0, "t", 0x0, "i", 0x0, "o", 0x0, "n", 0x0, "."
	DCB	0x0, "c", 0x0, "p", 0x0, "p", 0x0, 0x0, 0x0 ; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1FK@FNONLNGN@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAD?$AAE?$AAB?$AAU?$AAG?$AAC?$AAH?$AAK?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?5?$AAi?$AAn?$AA?5?$AAf?$AAi?$AAl?$AAe?$AA?5?$AA?$CF?$AAs?$AA?5?$AAa@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "D", 0x0, "E", 0x0, "B"
	DCB	0x0, "U", 0x0, "G", 0x0, "C", 0x0, "H", 0x0, "K", 0x0, " "
	DCB	0x0, "f", 0x0, "a", 0x0, "i", 0x0, "l", 0x0, "e", 0x0, "d"
	DCB	0x0, " ", 0x0, "i", 0x0, "n", 0x0, " ", 0x0, "f", 0x0, "i"
	DCB	0x0, "l", 0x0, "e", 0x0, " ", 0x0, "%", 0x0, "s", 0x0, " "
	DCB	0x0, "a", 0x0, "t", 0x0, " ", 0x0, "l", 0x0, "i", 0x0, "n"
	DCB	0x0, "e", 0x0, " ", 0x0, "%", 0x0, "d", 0x0, " ", 0x0, 0xd
	DCB	0x0, 0xa, 0x0, 0x0, 0x0			; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1DG@KMABPNDO@?$AAP?$AAm?$AAR?$AAe?$AAl?$AAe?$AAa?$AAs?$AAe?$AAP?$AAo?$AAw?$AAe?$AAr?$AAR?$AAe?$AAl?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AAh?$AAi?$AAp?$AA?$AA@| DCB "P"
	DCB	0x0, "m", 0x0, "R", 0x0, "e", 0x0, "l", 0x0, "e", 0x0, "a"
	DCB	0x0, "s", 0x0, "e", 0x0, "P", 0x0, "o", 0x0, "w", 0x0, "e"
	DCB	0x0, "r", 0x0, "R", 0x0, "e", 0x0, "l", 0x0, "a", 0x0, "t"
	DCB	0x0, "i", 0x0, "o", 0x0, "n", 0x0, "s", 0x0, "h", 0x0, "i"
	DCB	0x0, "p", 0x0, 0x0, 0x0			; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1CO@JNMCMHEL@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAl?$AAe?$AAa?$AAs?$AAi?$AAn?$AAg?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?$AN?$AA?6?$AA?$AA@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "r", 0x0, "e", 0x0, "l"
	DCB	0x0, "e", 0x0, "a", 0x0, "s", 0x0, "i", 0x0, "n", 0x0, "g"
	DCB	0x0, " ", 0x0, "0", 0x0, "x", 0x0, "%", 0x0, "0", 0x0, "8"
	DCB	0x0, "x", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0 ; `string'
; Function compile flags: /Ogsp
; File c:\wince800\platform\rrm_ppc_windows\src\drivers\pm\mdd\pmrelation.cpp

  00064			 AREA	 |.text|, CODE, THUMB

  00064		 |PmReleasePowerRelationship| PROC

; 125  : {

  00064		 |$LN16@PmReleaseP|
  00064	e92d 4878	 push        {r3-r6,r11,lr}
  00068	f20d 0b10	 addw        r11,sp,#0x10
  0006c		 |$M14|

; 126  :     PDEVICE_STATE pds = (PDEVICE_STATE) h;
; 127  :     DWORD dwStatus = ERROR_INVALID_PARAMETER;
; 128  :     SETFNAME(_T("PmReleasePowerRelationship"));
; 129  : 
; 130  :     PMLOGMSG(ZONE_API, (_T("%s: releasing 0x%08x\r\n"), pszFname, h));

  0006c	4e24		 ldr         r6,|$LN24@PmReleaseP| ; =|dpCurSettings|
  0006e	2557		 movs        r5,#0x57
  00070	4604		 mov         r4,r0
  00072	f8d6 3440	 ldr         r3,[r6,#0x440]
  00076	f413 6f00	 tst         r3,#0x800
  0007a	d009		 beq         |$LN5@PmReleaseP|
  0007c	491c		 ldr         r1,|$LN20@PmReleaseP| ; =|??_C@_1DG@KMABPNDO@?$AAP?$AAm?$AAR?$AAe?$AAl?$AAe?$AAa?$AAs?$AAe?$AAP?$AAo?$AAw?$AAe?$AAr?$AAR?$AAe?$AAl?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AAh?$AAi?$AAp?$AA?$AA@|
  0007e	4602		 mov         r2,r0
  00080	481e		 ldr         r0,|$LN23@PmReleaseP| ; =|??_C@_1CO@JNMCMHEL@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAl?$AAe?$AAa?$AAs?$AAi?$AAn?$AAg?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?$AN?$AA?6?$AA?$AA@|
  00082	f000 f800	 bl          NKDbgPrintfW
  00086	491a		 ldr         r1,|$LN20@PmReleaseP| ; =|??_C@_1DG@KMABPNDO@?$AAP?$AAm?$AAR?$AAe?$AAl?$AAe?$AAa?$AAs?$AAe?$AAP?$AAo?$AAw?$AAe?$AAr?$AAR?$AAe?$AAl?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AAh?$AAi?$AAp?$AA?$AA@|
  00088	481c		 ldr         r0,|$LN23@PmReleaseP| ; =|??_C@_1CO@JNMCMHEL@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAl?$AAe?$AAa?$AAs?$AAi?$AAn?$AAg?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?$AN?$AA?6?$AA?$AA@|
  0008a	4622		 mov         r2,r4
  0008c	f000 f800	 bl          CeLogMsg
  00090		 |$LN5@PmReleaseP|

; 131  : 
; 132  :     // make sure that this pointer is a child node with a parent
; 133  :     if(pds != NULL) {

  00090	b1ac		 cbz         r4,|$LN12@PmReleaseP|

; 134  :         BOOL fExists = CheckDevicePointer(pds); // increments refcnt if TRUE

  00092	4620		 mov         r0,r4
  00094	f000 f800	 bl          CheckDevicePointer

; 135  :         if(fExists) {

  00098	b188		 cbz         r0,|$LN12@PmReleaseP|

; 136  :             // delete the device
; 137  :             PREFAST_DEBUGCHK(pds->pListHead != NULL);

  0009a	6e63		 ldr         r3,[r4,#0x64]
  0009c	b933		 cbnz        r3,|$LN8@PmReleaseP|
  0009e	4a16		 ldr         r2,|$LN22@PmReleaseP| ; =|??_C@_1IO@ENPFMAPK@?$AAc?$AA?3?$AA?2?$AAw?$AAi?$AAn?$AAc?$AAe?$AA8?$AA0?$AA0?$AA?2?$AAp?$AAl?$AAa?$AAt?$AAf?$AAo?$AAr?$AAm?$AA?2?$AAr?$AAr?$AAm?$AA_?$AAp?$AAp?$AAc?$AA_?$AAw?$AAi?$AAn@|
  000a0	4814		 ldr         r0,|$LN21@PmReleaseP| ; =|??_C@_1FK@FNONLNGN@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAD?$AAE?$AAB?$AAU?$AAG?$AAC?$AAH?$AAK?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?5?$AAi?$AAn?$AA?5?$AAf?$AAi?$AAl?$AAe?$AA?5?$AA?$CF?$AAs?$AA?5?$AAa@|
  000a2	2389		 movs        r3,#0x89
  000a4	4631		 mov         r1,r6
  000a6	f000 f800	 bl          NKDbgPrintfW
  000aa	defe		 __debugbreak
  000ac		 |$LN8@PmReleaseP|

; 138  :             RemoveDevice(pds->pListHead->pGuid, pds->pszName);

  000ac	6e63		 ldr         r3,[r4,#0x64]
  000ae	6821		 ldr         r1,[r4]
  000b0	6818		 ldr         r0,[r3]
  000b2	f000 f800	 bl          RemoveDevice

; 139  : 
; 140  :             // done with the pointer
; 141  :             DeviceStateDecRef(pds);

  000b6	4620		 mov         r0,r4
  000b8	f000 f800	 bl          DeviceStateDecRef

; 142  : 
; 143  :             // return a good status
; 144  :             dwStatus = ERROR_SUCCESS;

  000bc	2500		 movs        r5,#0
  000be		 |$LN12@PmReleaseP|

; 145  :         }
; 146  :     }
; 147  : 
; 148  :     PMLOGMSG(ZONE_API || (dwStatus != ERROR_SUCCESS && ZONE_WARN), (_T("%s: returning %d\r\n"), 
; 149  :         pszFname, dwStatus));

  000be	f8d6 3440	 ldr         r3,[r6,#0x440]
  000c2	f413 6f00	 tst         r3,#0x800
  000c6	d103		 bne         |$LN10@PmReleaseP|
  000c8	b165		 cbz         r5,|$LN11@PmReleaseP|
  000ca	f013 0f02	 tst         r3,#2
  000ce	d009		 beq         |$LN11@PmReleaseP|
  000d0		 |$LN10@PmReleaseP|
  000d0	4907		 ldr         r1,|$LN20@PmReleaseP| ; =|??_C@_1DG@KMABPNDO@?$AAP?$AAm?$AAR?$AAe?$AAl?$AAe?$AAa?$AAs?$AAe?$AAP?$AAo?$AAw?$AAe?$AAr?$AAR?$AAe?$AAl?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AAh?$AAi?$AAp?$AA?$AA@|
  000d2	4806		 ldr         r0,|$LN19@PmReleaseP| ; =|??_C@_1CG@EPNLEKEF@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AA?$CF?$AAd?$AA?$AN?$AA?6?$AA?$AA@|
  000d4	462a		 mov         r2,r5
  000d6	f000 f800	 bl          NKDbgPrintfW
  000da	4905		 ldr         r1,|$LN20@PmReleaseP| ; =|??_C@_1DG@KMABPNDO@?$AAP?$AAm?$AAR?$AAe?$AAl?$AAe?$AAa?$AAs?$AAe?$AAP?$AAo?$AAw?$AAe?$AAr?$AAR?$AAe?$AAl?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AAh?$AAi?$AAp?$AA?$AA@|
  000dc	4803		 ldr         r0,|$LN19@PmReleaseP| ; =|??_C@_1CG@EPNLEKEF@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AA?$CF?$AAd?$AA?$AN?$AA?6?$AA?$AA@|
  000de	462a		 mov         r2,r5
  000e0	f000 f800	 bl          CeLogMsg
  000e4		 |$LN11@PmReleaseP|

; 150  :     return dwStatus;
; 151  : }

  000e4	4628		 mov         r0,r5
  000e6		 |$M17|
  000e6	e8bd 8878	 pop         {r3-r6,r11,pc}
  000ea		 |$LN25@PmReleaseP|
  000ea		 |$M26|
  000ea	defe		 __debugbreak
  000ec		 |$LN18@PmReleaseP|
  000ec		 |$LN19@PmReleaseP|
  000ec	0000 0000	 DCD         |??_C@_1CG@EPNLEKEF@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AA?$CF?$AAd?$AA?$AN?$AA?6?$AA?$AA@|
  000f0		 |$LN20@PmReleaseP|
  000f0	0000 0000	 DCD         |??_C@_1DG@KMABPNDO@?$AAP?$AAm?$AAR?$AAe?$AAl?$AAe?$AAa?$AAs?$AAe?$AAP?$AAo?$AAw?$AAe?$AAr?$AAR?$AAe?$AAl?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AAh?$AAi?$AAp?$AA?$AA@|
  000f4		 |$LN21@PmReleaseP|
  000f4	0000 0000	 DCD         |??_C@_1FK@FNONLNGN@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAD?$AAE?$AAB?$AAU?$AAG?$AAC?$AAH?$AAK?$AA?5?$AAf?$AAa?$AAi?$AAl?$AAe?$AAd?$AA?5?$AAi?$AAn?$AA?5?$AAf?$AAi?$AAl?$AAe?$AA?5?$AA?$CF?$AAs?$AA?5?$AAa@|
  000f8		 |$LN22@PmReleaseP|
  000f8	0000 0000	 DCD         |??_C@_1IO@ENPFMAPK@?$AAc?$AA?3?$AA?2?$AAw?$AAi?$AAn?$AAc?$AAe?$AA8?$AA0?$AA0?$AA?2?$AAp?$AAl?$AAa?$AAt?$AAf?$AAo?$AAr?$AAm?$AA?2?$AAr?$AAr?$AAm?$AA_?$AAp?$AAp?$AAc?$AA_?$AAw?$AAi?$AAn@|
  000fc		 |$LN23@PmReleaseP|
  000fc	0000 0000	 DCD         |??_C@_1CO@JNMCMHEL@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAl?$AAe?$AAa?$AAs?$AAi?$AAn?$AAg?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?$AN?$AA?6?$AA?$AA@|
  00100		 |$LN24@PmReleaseP|
  00100	0000 0000	 DCD         |dpCurSettings|
  00104		 |$M15|

			 ENDP  ; |PmReleasePowerRelationship|

	EXPORT	|??_C@_1M@LFABOLDL@?$AA?$CL?$AA?$CF?$AAs?$AA?$AN?$AA?6?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1DI@DGDFELFJ@?$AAP?$AAm?$AAR?$AAe?$AAg?$AAi?$AAs?$AAt?$AAe?$AAr?$AAP?$AAo?$AAw?$AAe?$AAr?$AAR?$AAe?$AAl?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AAh?$AAi?$AAp?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1EA@FDDAEBKJ@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAc?$AAh?$AAi?$AAl?$AAd?$AA?5?$AA?8?$AA?$CF?$AAs?$AA?8?$AA?5?$AAa?$AAl?$AAr?$AAe?$AAa?$AAd?$AAy?$AA?5?$AAe?$AAx?$AAi?$AAs?$AAt?$AAs?$AA?$AN?$AA?6?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1DK@GPNMCGNE@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAc?$AAa?$AAn?$AA?8?$AAt?$AA?5?$AAf?$AAi?$AAn?$AAd?$AA?5?$AAp?$AAa?$AAr?$AAe?$AAn?$AAt?$AA?5?$AA?8?$AA?$CF?$AAs?$AA?8?$AA?$AN?$AA?6?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1FA@NJGFJEJM@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAp?$AAa?$AAr?$AAe?$AAn?$AAt?$AA?5?$AA?8?$AA?$CF?$AAs?$AA?8?$AA?5?$AAc?$AAa?$AAn?$AA?8?$AAt?$AA?5?$AAa?$AAl?$AAs?$AAo?$AA?5?$AAb?$AAe?$AA?5?$AAa?$AA?5@| [ DATA ] ; `string'
	EXPORT	|??_C@_1FG@GFDCDANC@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAc?$AAa?$AAn?$AA?8?$AAt?$AA?5?$AAf?$AAi?$AAn?$AAd?$AA?5?$AAc?$AAl?$AAa?$AAs?$AAs?$AA?5?$AAf?$AAo?$AAr?$AA?5?$AAp?$AAa?$AAr?$AAe?$AAn?$AAt?$AA?5@| [ DATA ] ; `string'
	EXPORT	|??_C@_1EK@KBCPAFO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?0?$AA?5?$AAs?$AAt?$AAa?$AAt?$AAu?$AAs?$AA?5?$AAi?$AAs?$AA?5@| [ DATA ] ; `string'
	EXPORT	|PmRegisterPowerRelationship|
	IMPORT	|DeviceIdParseNameString|
	IMPORT	|GetDeviceListFromClass|
	IMPORT	|DeviceStateFindList|
	IMPORT	|AddDevice|
	IMPORT	|DeviceIdDestroy|
	IMPORT	|SetLastError|

  00010			 AREA	 |.pdata|, PDATA
|$pdata1$PmRegisterPowerRelationship| DCD imagerel |$LN40@PmRegister|
	DCD	0xfdb66345

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1EK@KBCPAFO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?0?$AA?5?$AAs?$AAt?$AAa?$AAt?$AAu?$AAs?$AA?5?$AAi?$AAs?$AA?5@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "r", 0x0, "e", 0x0, "t"
	DCB	0x0, "u", 0x0, "r", 0x0, "n", 0x0, "i", 0x0, "n", 0x0, "g"
	DCB	0x0, " ", 0x0, "0", 0x0, "x", 0x0, "%", 0x0, "0", 0x0, "8"
	DCB	0x0, "x", 0x0, ",", 0x0, " ", 0x0, "s", 0x0, "t", 0x0, "a"
	DCB	0x0, "t", 0x0, "u", 0x0, "s", 0x0, " ", 0x0, "i", 0x0, "s"
	DCB	0x0, " ", 0x0, "%", 0x0, "d", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0
	DCB	0x0					; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1FG@GFDCDANC@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAc?$AAa?$AAn?$AA?8?$AAt?$AA?5?$AAf?$AAi?$AAn?$AAd?$AA?5?$AAc?$AAl?$AAa?$AAs?$AAs?$AA?5?$AAf?$AAo?$AAr?$AA?5?$AAp?$AAa?$AAr?$AAe?$AAn?$AAt?$AA?5@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "c", 0x0, "a", 0x0, "n"
	DCB	0x0, "'", 0x0, "t", 0x0, " ", 0x0, "f", 0x0, "i", 0x0, "n"
	DCB	0x0, "d", 0x0, " ", 0x0, "c", 0x0, "l", 0x0, "a", 0x0, "s"
	DCB	0x0, "s", 0x0, " ", 0x0, "f", 0x0, "o", 0x0, "r", 0x0, " "
	DCB	0x0, "p", 0x0, "a", 0x0, "r", 0x0, "e", 0x0, "n", 0x0, "t"
	DCB	0x0, " ", 0x0, "o", 0x0, "r", 0x0, " ", 0x0, "c", 0x0, "h"
	DCB	0x0, "i", 0x0, "l", 0x0, "d", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0
	DCB	0x0					; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1FA@NJGFJEJM@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAp?$AAa?$AAr?$AAe?$AAn?$AAt?$AA?5?$AA?8?$AA?$CF?$AAs?$AA?8?$AA?5?$AAc?$AAa?$AAn?$AA?8?$AAt?$AA?5?$AAa?$AAl?$AAs?$AAo?$AA?5?$AAb?$AAe?$AA?5?$AAa?$AA?5@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "p", 0x0, "a", 0x0, "r"
	DCB	0x0, "e", 0x0, "n", 0x0, "t", 0x0, " ", 0x0, "'", 0x0, "%"
	DCB	0x0, "s", 0x0, "'", 0x0, " ", 0x0, "c", 0x0, "a", 0x0, "n"
	DCB	0x0, "'", 0x0, "t", 0x0, " ", 0x0, "a", 0x0, "l", 0x0, "s"
	DCB	0x0, "o", 0x0, " ", 0x0, "b", 0x0, "e", 0x0, " ", 0x0, "a"
	DCB	0x0, " ", 0x0, "c", 0x0, "h", 0x0, "i", 0x0, "l", 0x0, "d"
	DCB	0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0	; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1DK@GPNMCGNE@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAc?$AAa?$AAn?$AA?8?$AAt?$AA?5?$AAf?$AAi?$AAn?$AAd?$AA?5?$AAp?$AAa?$AAr?$AAe?$AAn?$AAt?$AA?5?$AA?8?$AA?$CF?$AAs?$AA?8?$AA?$AN?$AA?6?$AA?$AA@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "c", 0x0, "a", 0x0, "n"
	DCB	0x0, "'", 0x0, "t", 0x0, " ", 0x0, "f", 0x0, "i", 0x0, "n"
	DCB	0x0, "d", 0x0, " ", 0x0, "p", 0x0, "a", 0x0, "r", 0x0, "e"
	DCB	0x0, "n", 0x0, "t", 0x0, " ", 0x0, "'", 0x0, "%", 0x0, "s"
	DCB	0x0, "'", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0 ; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1EA@FDDAEBKJ@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAc?$AAh?$AAi?$AAl?$AAd?$AA?5?$AA?8?$AA?$CF?$AAs?$AA?8?$AA?5?$AAa?$AAl?$AAr?$AAe?$AAa?$AAd?$AAy?$AA?5?$AAe?$AAx?$AAi?$AAs?$AAt?$AAs?$AA?$AN?$AA?6?$AA?$AA@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "c", 0x0, "h", 0x0, "i"
	DCB	0x0, "l", 0x0, "d", 0x0, " ", 0x0, "'", 0x0, "%", 0x0, "s"
	DCB	0x0, "'", 0x0, " ", 0x0, "a", 0x0, "l", 0x0, "r", 0x0, "e"
	DCB	0x0, "a", 0x0, "d", 0x0, "y", 0x0, " ", 0x0, "e", 0x0, "x"
	DCB	0x0, "i", 0x0, "s", 0x0, "t", 0x0, "s", 0x0, 0xd, 0x0, 0xa
	DCB	0x0, 0x0, 0x0				; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1DI@DGDFELFJ@?$AAP?$AAm?$AAR?$AAe?$AAg?$AAi?$AAs?$AAt?$AAe?$AAr?$AAP?$AAo?$AAw?$AAe?$AAr?$AAR?$AAe?$AAl?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AAh?$AAi?$AAp?$AA?$AA@| DCB "P"
	DCB	0x0, "m", 0x0, "R", 0x0, "e", 0x0, "g", 0x0, "i", 0x0, "s"
	DCB	0x0, "t", 0x0, "e", 0x0, "r", 0x0, "P", 0x0, "o", 0x0, "w"
	DCB	0x0, "e", 0x0, "r", 0x0, "R", 0x0, "e", 0x0, "l", 0x0, "a"
	DCB	0x0, "t", 0x0, "i", 0x0, "o", 0x0, "n", 0x0, "s", 0x0, "h"
	DCB	0x0, "i", 0x0, "p", 0x0, 0x0, 0x0	; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1M@LFABOLDL@?$AA?$CL?$AA?$CF?$AAs?$AA?$AN?$AA?6?$AA?$AA@| DCB "+", 0x0
	DCB	"%", 0x0, "s", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0 ; `string'
; Function compile flags: /Ogsp
; File c:\wince800\platform\rrm_ppc_windows\src\drivers\pm\mdd\pmrelation.cpp

  00104			 AREA	 |.text|, CODE, THUMB

  00104		 |PmRegisterPowerRelationship| PROC

; 39   : {

  00104		 |$LN40@PmRegister|
  00104	e92d 4ffe	 push        {r1-r11,lr}
  00108	f20d 0b28	 addw        r11,sp,#0x28
  0010c		 |$M38|

; 40   :     PDEVICEID pdiParent = NULL, pdiChild = NULL;
; 41   :     PDEVICE_LIST pdlParent, pdlChild = NULL;
; 42   :     PDEVICE_STATE pdsParent = NULL;
; 43   :     PDEVICE_STATE pdsChild = NULL;
; 44   :     DWORD dwStatus = ERROR_SUCCESS;
; 45   :     SETFNAME(_T("PmRegisterPowerRelationship"));
; 46   : 
; 47   :     PMLOGMSG(ZONE_API, (_T("+%s\r\n"), pszFname));

  0010c	4e6d		 ldr         r6,|$LN50@PmRegister| ; =|dpCurSettings|
  0010e	469e		 mov         lr,r3
  00110	9300		 str         r3,[sp]
  00112	f8d6 4440	 ldr         r4,[r6,#0x440]
  00116	460b		 mov         r3,r1
  00118	f04f 0900	 mov         r9,#0
  0011c	2700		 movs        r7,#0
  0011e	f04f 0800	 mov         r8,#0
  00122	2500		 movs        r5,#0
  00124	f414 6f00	 tst         r4,#0x800
  00128	9202		 str         r2,[sp,#8]
  0012a	9301		 str         r3,[sp,#4]
  0012c	4682		 mov         r10,r0
  0012e	d00a		 beq         |$LN21@PmRegister|
  00130	495e		 ldr         r1,|$LN44@PmRegister| ; =|??_C@_1DI@DGDFELFJ@?$AAP?$AAm?$AAR?$AAe?$AAg?$AAi?$AAs?$AAt?$AAe?$AAr?$AAP?$AAo?$AAw?$AAe?$AAr?$AAR?$AAe?$AAl?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AAh?$AAi?$AAp?$AA?$AA@|
  00132	4863		 ldr         r0,|$LN49@PmRegister| ; =|??_C@_1M@LFABOLDL@?$AA?$CL?$AA?$CF?$AAs?$AA?$AN?$AA?6?$AA?$AA@|
  00134	f000 f800	 bl          NKDbgPrintfW
  00138	495c		 ldr         r1,|$LN44@PmRegister| ; =|??_C@_1DI@DGDFELFJ@?$AAP?$AAm?$AAR?$AAe?$AAg?$AAi?$AAs?$AAt?$AAe?$AAr?$AAP?$AAo?$AAw?$AAe?$AAr?$AAR?$AAe?$AAl?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AAh?$AAi?$AAp?$AA?$AA@|
  0013a	4861		 ldr         r0,|$LN49@PmRegister| ; =|??_C@_1M@LFABOLDL@?$AA?$CL?$AA?$CF?$AAs?$AA?$AN?$AA?6?$AA?$AA@|
  0013c	f000 f800	 bl          CeLogMsg
  00140	f8dd e000	 ldr         lr,[sp]
  00144	9b01		 ldr         r3,[sp,#4]
  00146		 |$LN21@PmRegister|

; 48   : 
; 49   :     // sanity check parameters
; 50   :     if(pvParent == NULL 
; 51   :     || pvChild == NULL
; 52   :     || (pdiParent = DeviceIdParseNameString((LPCTSTR) pvParent, dwFlags)) == NULL
; 53   :     || (pdiChild = DeviceIdParseNameString((LPCTSTR) pvChild, dwFlags)) == NULL) {

  00146	f1ba 0f00	 cmp         r10,#0
  0014a	f000 8084	 beq         |$LN36@PmRegister|
  0014e	2b00		 cmp         r3,#0
  00150	f000 8081	 beq         |$LN36@PmRegister|
  00154	4671		 mov         r1,lr
  00156	4650		 mov         r0,r10
  00158	f000 f800	 bl          DeviceIdParseNameString
  0015c	4681		 mov         r9,r0
  0015e	2800		 cmp         r0,#0
  00160	d079		 beq         |$LN36@PmRegister|
  00162	9900		 ldr         r1,[sp]
  00164	9801		 ldr         r0,[sp,#4]
  00166	f000 f800	 bl          DeviceIdParseNameString
  0016a	4607		 mov         r7,r0
  0016c	2f00		 cmp         r7,#0
  0016e	d072		 beq         |$LN36@PmRegister|

; 55   :     }
; 56   : 
; 57   :     // parameters ok so far?
; 58   :     if(dwStatus == ERROR_SUCCESS) {
; 59   :         pdlChild = GetDeviceListFromClass(pdiChild->pGuid);

  00170	6838		 ldr         r0,[r7]
  00172	f000 f800	 bl          GetDeviceListFromClass
  00176	4682		 mov         r10,r0

; 60   :         if(dwStatus == ERROR_SUCCESS) {
; 61   :             // Look up device lists for parent and child, plus the parent
; 62   :             // and child device structures.  The child cannot already exist.
; 63   :             pdlParent = GetDeviceListFromClass(pdiParent->pGuid);

  00178	f8d9 0000	 ldr         r0,[r9]
  0017c	f000 f800	 bl          GetDeviceListFromClass
  00180	4604		 mov         r4,r0

; 64   :             if(pdlParent == NULL || pdlChild == NULL) {

  00182	2c00		 cmp         r4,#0
  00184	d05a		 beq         |$LN13@PmRegister|
  00186	f1ba 0f00	 cmp         r10,#0
  0018a	d057		 beq         |$LN13@PmRegister|

; 67   :                 dwStatus = ERROR_INVALID_PARAMETER;
; 68   :             } else if((pdsChild = DeviceStateFindList(pdlChild, pdiChild->pszName)) != NULL) {

  0018c	6879		 ldr         r1,[r7,#4]
  0018e	4650		 mov         r0,r10
  00190	f000 f800	 bl          DeviceStateFindList
  00194	4680		 mov         r8,r0
  00196	b198		 cbz         r0,|$LN11@PmRegister|

; 69   :                 PMLOGMSG(ZONE_WARN, (_T("%s: child '%s' already exists\r\n"),
; 70   :                     pszFname, pdiChild->pszName));

  00198	f8d6 3440	 ldr         r3,[r6,#0x440]
  0019c	f013 0f02	 tst         r3,#2
  001a0	d009		 beq         |$LN25@PmRegister|
  001a2	687a		 ldr         r2,[r7,#4]
  001a4	4941		 ldr         r1,|$LN44@PmRegister| ; =|??_C@_1DI@DGDFELFJ@?$AAP?$AAm?$AAR?$AAe?$AAg?$AAi?$AAs?$AAt?$AAe?$AAr?$AAP?$AAo?$AAw?$AAe?$AAr?$AAR?$AAe?$AAl?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AAh?$AAi?$AAp?$AA?$AA@|
  001a6	4845		 ldr         r0,|$LN48@PmRegister| ; =|??_C@_1EA@FDDAEBKJ@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAc?$AAh?$AAi?$AAl?$AAd?$AA?5?$AA?8?$AA?$CF?$AAs?$AA?8?$AA?5?$AAa?$AAl?$AAr?$AAe?$AAa?$AAd?$AAy?$AA?5?$AAe?$AAx?$AAi?$AAs?$AAt?$AAs?$AA?$AN?$AA?6?$AA?$AA@|
  001a8	f000 f800	 bl          NKDbgPrintfW
  001ac	687a		 ldr         r2,[r7,#4]
  001ae	493f		 ldr         r1,|$LN44@PmRegister| ; =|??_C@_1DI@DGDFELFJ@?$AAP?$AAm?$AAR?$AAe?$AAg?$AAi?$AAs?$AAt?$AAe?$AAr?$AAP?$AAo?$AAw?$AAe?$AAr?$AAR?$AAe?$AAl?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AAh?$AAi?$AAp?$AA?$AA@|
  001b0	4842		 ldr         r0,|$LN48@PmRegister| ; =|??_C@_1EA@FDDAEBKJ@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAc?$AAh?$AAi?$AAl?$AAd?$AA?5?$AA?8?$AA?$CF?$AAs?$AA?8?$AA?5?$AAa?$AAl?$AAr?$AAe?$AAa?$AAd?$AAy?$AA?5?$AAe?$AAx?$AAi?$AAs?$AAt?$AAs?$AA?$AN?$AA?6?$AA?$AA@|
  001b2	f000 f800	 bl          CeLogMsg
  001b6		 |$LN25@PmRegister|

; 71   :                 DeviceStateDecRef(pdsChild);

  001b6	4640		 mov         r0,r8
  001b8	f000 f800	 bl          DeviceStateDecRef

; 72   :                 dwStatus = ERROR_FILE_EXISTS;

  001bc	2550		 movs        r5,#0x50

; 73   :             } else {

  001be	e04b		 b           |$LN3@PmRegister|
  001c0		 |$LN11@PmRegister|

; 74   :                 pdsParent = DeviceStateFindList(pdlParent, pdiParent->pszName);

  001c0	f8d9 1004	 ldr         r1,[r9,#4]
  001c4	4620		 mov         r0,r4
  001c6	f000 f800	 bl          DeviceStateFindList
  001ca	4604		 mov         r4,r0

; 75   :                 if(pdsParent == NULL) {

  001cc	b98c		 cbnz        r4,|$LN9@PmRegister|

; 76   :                     PMLOGMSG(ZONE_WARN, (_T("%s: can't find parent '%s'\r\n"), 
; 77   :                         pszFname, pdiParent->pszName));

  001ce	f8d6 3440	 ldr         r3,[r6,#0x440]
  001d2	f013 0f02	 tst         r3,#2
  001d6	d03e		 beq         |$LN36@PmRegister|
  001d8	f8d9 2004	 ldr         r2,[r9,#4]
  001dc	4933		 ldr         r1,|$LN44@PmRegister| ; =|??_C@_1DI@DGDFELFJ@?$AAP?$AAm?$AAR?$AAe?$AAg?$AAi?$AAs?$AAt?$AAe?$AAr?$AAP?$AAo?$AAw?$AAe?$AAr?$AAR?$AAe?$AAl?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AAh?$AAi?$AAp?$AA?$AA@|
  001de	4836		 ldr         r0,|$LN47@PmRegister| ; =|??_C@_1DK@GPNMCGNE@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAc?$AAa?$AAn?$AA?8?$AAt?$AA?5?$AAf?$AAi?$AAn?$AAd?$AA?5?$AAp?$AAa?$AAr?$AAe?$AAn?$AAt?$AA?5?$AA?8?$AA?$CF?$AAs?$AA?8?$AA?$AN?$AA?6?$AA?$AA@|
  001e0	f000 f800	 bl          NKDbgPrintfW
  001e4	f8d9 2004	 ldr         r2,[r9,#4]
  001e8	4930		 ldr         r1,|$LN44@PmRegister| ; =|??_C@_1DI@DGDFELFJ@?$AAP?$AAm?$AAR?$AAe?$AAg?$AAi?$AAs?$AAt?$AAe?$AAr?$AAP?$AAo?$AAw?$AAe?$AAr?$AAR?$AAe?$AAl?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AAh?$AAi?$AAp?$AA?$AA@|
  001ea	4833		 ldr         r0,|$LN47@PmRegister| ; =|??_C@_1DK@GPNMCGNE@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAc?$AAa?$AAn?$AA?8?$AAt?$AA?5?$AAf?$AAi?$AAn?$AAd?$AA?5?$AAp?$AAa?$AAr?$AAe?$AAn?$AAt?$AA?5?$AA?8?$AA?$CF?$AAs?$AA?8?$AA?$AN?$AA?6?$AA?$AA@|
  001ec	f000 f800	 bl          CeLogMsg

; 78   :                     dwStatus = ERROR_INVALID_PARAMETER;

  001f0	e031		 b           |$LN36@PmRegister|
  001f2		 |$LN9@PmRegister|

; 79   :                 } else if(pdsParent->pParent != NULL) {

  001f2	6a63		 ldr         r3,[r4,#0x24]
  001f4	b173		 cbz         r3,|$LN35@PmRegister|

; 80   :                     PMLOGMSG(ZONE_WARN, (_T("%s: parent '%s' can't also be a child\r\n"),
; 81   :                         pszFname, pdsParent->pszName));

  001f6	f8d6 3440	 ldr         r3,[r6,#0x440]
  001fa	f013 0f02	 tst         r3,#2
  001fe	d009		 beq         |$LN35@PmRegister|
  00200	6822		 ldr         r2,[r4]
  00202	492a		 ldr         r1,|$LN44@PmRegister| ; =|??_C@_1DI@DGDFELFJ@?$AAP?$AAm?$AAR?$AAe?$AAg?$AAi?$AAs?$AAt?$AAe?$AAr?$AAP?$AAo?$AAw?$AAe?$AAr?$AAR?$AAe?$AAl?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AAh?$AAi?$AAp?$AA?$AA@|
  00204	482b		 ldr         r0,|$LN46@PmRegister| ; =|??_C@_1FA@NJGFJEJM@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAp?$AAa?$AAr?$AAe?$AAn?$AAt?$AA?5?$AA?8?$AA?$CF?$AAs?$AA?8?$AA?5?$AAc?$AAa?$AAn?$AA?8?$AAt?$AA?5?$AAa?$AAl?$AAs?$AAo?$AA?5?$AAb?$AAe?$AA?5?$AAa?$AA?5@|
  00206	f000 f800	 bl          NKDbgPrintfW
  0020a	6822		 ldr         r2,[r4]
  0020c	4927		 ldr         r1,|$LN44@PmRegister| ; =|??_C@_1DI@DGDFELFJ@?$AAP?$AAm?$AAR?$AAe?$AAg?$AAi?$AAs?$AAt?$AAe?$AAr?$AAP?$AAo?$AAw?$AAe?$AAr?$AAR?$AAe?$AAl?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AAh?$AAi?$AAp?$AA?$AA@|
  0020e	4829		 ldr         r0,|$LN46@PmRegister| ; =|??_C@_1FA@NJGFJEJM@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAp?$AAa?$AAr?$AAe?$AAn?$AAt?$AA?5?$AA?8?$AA?$CF?$AAs?$AA?8?$AA?5?$AAc?$AAa?$AAn?$AA?8?$AAt?$AA?5?$AAa?$AAl?$AAs?$AAo?$AA?5?$AAb?$AAe?$AA?5?$AAa?$AA?5@|
  00210	f000 f800	 bl          CeLogMsg
  00214		 |$LN35@PmRegister|

; 82   :                 }
; 83   :             }
; 84   :         }
; 85   :     }
; 86   : 
; 87   :     // if parameters were ok, proceed
; 88   :     if(dwStatus == ERROR_SUCCESS) {
; 89   :         // create and/or initialize the new device
; 90   :         AddDevice(pdiChild->pGuid, pdiChild->pszName, pdsParent, pCaps);

  00214	6879		 ldr         r1,[r7,#4]
  00216	6838		 ldr         r0,[r7]
  00218	9b02		 ldr         r3,[sp,#8]
  0021a	4622		 mov         r2,r4
  0021c	f000 f800	 bl          AddDevice

; 91   : 
; 92   :         // get the return value
; 93   :         pdsChild = DeviceStateFindList(pdlChild, pdiChild->pszName);

  00220	6879		 ldr         r1,[r7,#4]
  00222	4650		 mov         r0,r10
  00224	f000 f800	 bl          DeviceStateFindList
  00228	4680		 mov         r8,r0

; 94   :         if(pdsChild != NULL) {

  0022a	b110		 cbz         r0,|$LN5@PmRegister|

; 95   :             // we only want the pointer value for now
; 96   :             DeviceStateDecRef(pdsChild);

  0022c	f000 f800	 bl          DeviceStateDecRef

; 97   :         } else {

  00230	e000		 b           |$LN4@PmRegister|
  00232		 |$LN5@PmRegister|

; 98   :             // couldn't create the child device for some reason
; 99   :             dwStatus = ERROR_GEN_FAILURE;

  00232	251f		 movs        r5,#0x1F
  00234		 |$LN4@PmRegister|

; 100  :         }
; 101  :     }
; 102  : 
; 103  :     // release resources
; 104  :     if(pdsParent != NULL) DeviceStateDecRef(pdsParent);

  00234	4620		 mov         r0,r4
  00236	f000 f800	 bl          DeviceStateDecRef
  0023a	e00d		 b           |$LN3@PmRegister|
  0023c		 |$LN13@PmRegister|

; 40   :     PDEVICEID pdiParent = NULL, pdiChild = NULL;
; 41   :     PDEVICE_LIST pdlParent, pdlChild = NULL;
; 42   :     PDEVICE_STATE pdsParent = NULL;
; 43   :     PDEVICE_STATE pdsChild = NULL;
; 44   :     DWORD dwStatus = ERROR_SUCCESS;
; 45   :     SETFNAME(_T("PmRegisterPowerRelationship"));
; 46   : 
; 47   :     PMLOGMSG(ZONE_API, (_T("+%s\r\n"), pszFname));

  0023c	f8d6 3440	 ldr         r3,[r6,#0x440]

; 65   :                 PMLOGMSG(ZONE_WARN, (_T("%s: can't find class for parent or child\r\n"),
; 66   :                     pszFname));

  00240	f013 0f02	 tst         r3,#2
  00244	d007		 beq         |$LN36@PmRegister|
  00246	4919		 ldr         r1,|$LN44@PmRegister| ; =|??_C@_1DI@DGDFELFJ@?$AAP?$AAm?$AAR?$AAe?$AAg?$AAi?$AAs?$AAt?$AAe?$AAr?$AAP?$AAo?$AAw?$AAe?$AAr?$AAR?$AAe?$AAl?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AAh?$AAi?$AAp?$AA?$AA@|
  00248	4819		 ldr         r0,|$LN45@PmRegister| ; =|??_C@_1FG@GFDCDANC@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAc?$AAa?$AAn?$AA?8?$AAt?$AA?5?$AAf?$AAi?$AAn?$AAd?$AA?5?$AAc?$AAl?$AAa?$AAs?$AAs?$AA?5?$AAf?$AAo?$AAr?$AA?5?$AAp?$AAa?$AAr?$AAe?$AAn?$AAt?$AA?5@|
  0024a	f000 f800	 bl          NKDbgPrintfW
  0024e	4917		 ldr         r1,|$LN44@PmRegister| ; =|??_C@_1DI@DGDFELFJ@?$AAP?$AAm?$AAR?$AAe?$AAg?$AAi?$AAs?$AAt?$AAe?$AAr?$AAP?$AAo?$AAw?$AAe?$AAr?$AAR?$AAe?$AAl?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AAh?$AAi?$AAp?$AA?$AA@|
  00250	4817		 ldr         r0,|$LN45@PmRegister| ; =|??_C@_1FG@GFDCDANC@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAc?$AAa?$AAn?$AA?8?$AAt?$AA?5?$AAf?$AAi?$AAn?$AAd?$AA?5?$AAc?$AAl?$AAa?$AAs?$AAs?$AA?5?$AAf?$AAo?$AAr?$AA?5?$AAp?$AAa?$AAr?$AAe?$AAn?$AAt?$AA?5@|
  00252	f000 f800	 bl          CeLogMsg
  00256		 |$LN36@PmRegister|

; 54   :         dwStatus = ERROR_INVALID_PARAMETER;

  00256	2557		 movs        r5,#0x57
  00258		 |$LN3@PmRegister|

; 105  :     if(pdiParent != NULL) DeviceIdDestroy(pdiParent);

  00258	f1b9 0f00	 cmp         r9,#0
  0025c	d002		 beq         |$LN2@PmRegister|
  0025e	4648		 mov         r0,r9
  00260	f000 f800	 bl          DeviceIdDestroy
  00264		 |$LN2@PmRegister|

; 106  :     if(pdiChild != NULL) DeviceIdDestroy(pdiChild);

  00264	b117		 cbz         r7,|$LN1@PmRegister|
  00266	4638		 mov         r0,r7
  00268	f000 f800	 bl          DeviceIdDestroy
  0026c		 |$LN1@PmRegister|

; 107  : 
; 108  :     PMLOGMSG((dwStatus != ERROR_SUCCESS && ZONE_WARN) || ZONE_API, 
; 109  :         (_T("%s: returning 0x%08x, status is %d\r\n"), pszFname, pdsChild,
; 110  :         dwStatus));

  0026c	b125		 cbz         r5,|$LN31@PmRegister|
  0026e	f8d6 3440	 ldr         r3,[r6,#0x440]
  00272	f013 0f02	 tst         r3,#2
  00276	d104		 bne         |$LN32@PmRegister|
  00278		 |$LN31@PmRegister|

; 40   :     PDEVICEID pdiParent = NULL, pdiChild = NULL;
; 41   :     PDEVICE_LIST pdlParent, pdlChild = NULL;
; 42   :     PDEVICE_STATE pdsParent = NULL;
; 43   :     PDEVICE_STATE pdsChild = NULL;
; 44   :     DWORD dwStatus = ERROR_SUCCESS;
; 45   :     SETFNAME(_T("PmRegisterPowerRelationship"));
; 46   : 
; 47   :     PMLOGMSG(ZONE_API, (_T("+%s\r\n"), pszFname));

  00278	f8d6 3440	 ldr         r3,[r6,#0x440]

; 107  : 
; 108  :     PMLOGMSG((dwStatus != ERROR_SUCCESS && ZONE_WARN) || ZONE_API, 
; 109  :         (_T("%s: returning 0x%08x, status is %d\r\n"), pszFname, pdsChild,
; 110  :         dwStatus));

  0027c	f413 6f00	 tst         r3,#0x800
  00280	d00b		 beq         |$LN33@PmRegister|
  00282		 |$LN32@PmRegister|
  00282	490a		 ldr         r1,|$LN44@PmRegister| ; =|??_C@_1DI@DGDFELFJ@?$AAP?$AAm?$AAR?$AAe?$AAg?$AAi?$AAs?$AAt?$AAe?$AAr?$AAP?$AAo?$AAw?$AAe?$AAr?$AAR?$AAe?$AAl?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AAh?$AAi?$AAp?$AA?$AA@|
  00284	4808		 ldr         r0,|$LN43@PmRegister| ; =|??_C@_1EK@KBCPAFO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?0?$AA?5?$AAs?$AAt?$AAa?$AAt?$AAu?$AAs?$AA?5?$AAi?$AAs?$AA?5@|
  00286	462b		 mov         r3,r5
  00288	4642		 mov         r2,r8
  0028a	f000 f800	 bl          NKDbgPrintfW
  0028e	4907		 ldr         r1,|$LN44@PmRegister| ; =|??_C@_1DI@DGDFELFJ@?$AAP?$AAm?$AAR?$AAe?$AAg?$AAi?$AAs?$AAt?$AAe?$AAr?$AAP?$AAo?$AAw?$AAe?$AAr?$AAR?$AAe?$AAl?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AAh?$AAi?$AAp?$AA?$AA@|
  00290	4805		 ldr         r0,|$LN43@PmRegister| ; =|??_C@_1EK@KBCPAFO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?0?$AA?5?$AAs?$AAt?$AAa?$AAt?$AAu?$AAs?$AA?5?$AAi?$AAs?$AA?5@|
  00292	462b		 mov         r3,r5
  00294	4642		 mov         r2,r8
  00296	f000 f800	 bl          CeLogMsg
  0029a		 |$LN33@PmRegister|

; 111  :     SetLastError(dwStatus);

  0029a	4628		 mov         r0,r5
  0029c	f000 f800	 bl          SetLastError

; 112  :     return (HANDLE) pdsChild;
; 113  : }

  002a0	4640		 mov         r0,r8
  002a2		 |$M41|
  002a2	e8bd 8ffe	 pop         {r1-r11,pc}
  002a6		 |$LN51@PmRegister|
  002a6		 |$M52|
  002a6	defe		 __debugbreak
  002a8		 |$LN42@PmRegister|
  002a8		 |$LN43@PmRegister|
  002a8	0000 0000	 DCD         |??_C@_1EK@KBCPAFO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?0?$AA?5?$AAs?$AAt?$AAa?$AAt?$AAu?$AAs?$AA?5?$AAi?$AAs?$AA?5@|
  002ac		 |$LN44@PmRegister|
  002ac	0000 0000	 DCD         |??_C@_1DI@DGDFELFJ@?$AAP?$AAm?$AAR?$AAe?$AAg?$AAi?$AAs?$AAt?$AAe?$AAr?$AAP?$AAo?$AAw?$AAe?$AAr?$AAR?$AAe?$AAl?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AAh?$AAi?$AAp?$AA?$AA@|
  002b0		 |$LN45@PmRegister|
  002b0	0000 0000	 DCD         |??_C@_1FG@GFDCDANC@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAc?$AAa?$AAn?$AA?8?$AAt?$AA?5?$AAf?$AAi?$AAn?$AAd?$AA?5?$AAc?$AAl?$AAa?$AAs?$AAs?$AA?5?$AAf?$AAo?$AAr?$AA?5?$AAp?$AAa?$AAr?$AAe?$AAn?$AAt?$AA?5@|
  002b4		 |$LN46@PmRegister|
  002b4	0000 0000	 DCD         |??_C@_1FA@NJGFJEJM@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAp?$AAa?$AAr?$AAe?$AAn?$AAt?$AA?5?$AA?8?$AA?$CF?$AAs?$AA?8?$AA?5?$AAc?$AAa?$AAn?$AA?8?$AAt?$AA?5?$AAa?$AAl?$AAs?$AAo?$AA?5?$AAb?$AAe?$AA?5?$AAa?$AA?5@|
  002b8		 |$LN47@PmRegister|
  002b8	0000 0000	 DCD         |??_C@_1DK@GPNMCGNE@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAc?$AAa?$AAn?$AA?8?$AAt?$AA?5?$AAf?$AAi?$AAn?$AAd?$AA?5?$AAp?$AAa?$AAr?$AAe?$AAn?$AAt?$AA?5?$AA?8?$AA?$CF?$AAs?$AA?8?$AA?$AN?$AA?6?$AA?$AA@|
  002bc		 |$LN48@PmRegister|
  002bc	0000 0000	 DCD         |??_C@_1EA@FDDAEBKJ@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAc?$AAh?$AAi?$AAl?$AAd?$AA?5?$AA?8?$AA?$CF?$AAs?$AA?8?$AA?5?$AAa?$AAl?$AAr?$AAe?$AAa?$AAd?$AAy?$AA?5?$AAe?$AAx?$AAi?$AAs?$AAt?$AAs?$AA?$AN?$AA?6?$AA?$AA@|
  002c0		 |$LN49@PmRegister|
  002c0	0000 0000	 DCD         |??_C@_1M@LFABOLDL@?$AA?$CL?$AA?$CF?$AAs?$AA?$AN?$AA?6?$AA?$AA@|
  002c4		 |$LN50@PmRegister|
  002c4	0000 0000	 DCD         |dpCurSettings|
  002c8		 |$M39|

			 ENDP  ; |PmRegisterPowerRelationship|

	END
