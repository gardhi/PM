; Listing generated by Microsoft (R) Optimizing Compiler Version 17.00.50727.114 

	TTL	C:\wince800\platform\rrm_ppc_windows\src\drivers\pm\mdd\pmnotify.cpp
	THUMB

  00000			 AREA	 |.drectve|, DRECTVE
	DCB	"-defaultlib:LIBCMT "
	DCB	"-defaultlib:OLDNAMES "

	EXPORT	|KLibSetDeviceStateToIdle|
	IMPORT	|KernelLibIoControl|

  00000			 AREA	 |.pdata|, PDATA
|$pdata1$KLibSetDeviceStateToIdle| DCD imagerel |$LN6@KLibSetDev|
	DCD	0x1bf0049
; Function compile flags: /Ogsp
; File c:\wince800\public\common\oak\inc\pkfuncs.h

  00000			 AREA	 |.text|, CODE, THUMB

  00000		 |KLibSetDeviceStateToIdle| PROC

; 1632 : {

  00000		 |$LN6@KLibSetDev|
  00000	e92d 4800	 push        {r11,lr}
  00004	46eb		 mov         r11,sp
  00006	b086		 sub         sp,sp,#0x18
  00008		 |$M4|

; 1633 :     BOOL fForceCompaction = FALSE;

  00008	2300		 movs        r3,#0
  0000a	9304		 str         r3,[sp,#0x10]

; 1634 :     return KernelLibIoControl ((HANDLE) KMOD_CORE, IOCTL_KLIB_SET_DEVICE_STATE_TO_IDLE, &fForceCompaction, sizeof(fForceCompaction), NULL, 0, 0);    

  0000c	9302		 str         r3,[sp,#8]
  0000e	9301		 str         r3,[sp,#4]
  00010	9300		 str         r3,[sp]
  00012	2304		 movs        r3,#4
  00014	aa04		 add         r2,sp,#0x10
  00016	212c		 movs        r1,#0x2C
  00018	2001		 movs        r0,#1
  0001a	f000 f800	 bl          KernelLibIoControl
  0001e		 |$M7|

; 1635 : }

  0001e	b006		 add         sp,sp,#0x18
  00020	e8bd 8800	 pop         {r11,pc}
  00024		 |$M5|

			 ENDP  ; |KLibSetDeviceStateToIdle|

	IMPORT	|__security_push_cookie|
	IMPORT	|__security_pop_cookie|
	IMPORT	|__GSHandlerCheck|
	IMPORT	|StringCchVPrintfW|
	IMPORT	|StringCchLengthW|
	IMPORT	|CeLogData|

  00000			 AREA	 |.pdata|, PDATA
|$pdata1$CeLogMsg| DCD imagerel |$LN8@CeLogMsg|
	DCD	imagerel |$unwind2$CeLogMsg|

  00000			 AREA	 |.xdata|, DATA
|$unwind2$CeLogMsg| DCD 0x44b00032
	DCD	0x1e889e8
	DCD	0x400a8fb
	DCD	0x8801e8ff
	DCD	0xff05ef00
	DCD	imagerel |__GSHandlerCheck|
	DCD	0xffffffe5
; Function compile flags: /Ogsp
; File c:\wince800\public\common\sdk\inc\celog.h

  00000			 AREA	 |.text|, CODE, THUMB

  00000		 |CeLogMsg| PROC

; 1208 : {

  00000		 |$LN8@CeLogMsg|
  00000	b40f		 push        {r0-r3}
  00002	e92d 4800	 push        {r11,lr}
  00006	46eb		 mov         r11,sp
  00008	f000 f800	 bl          __security_push_cookie
  0000c	f2ad 2d24	 subw        sp,sp,#0x224
  00010		 |$M6|
  00010	4602		 mov         r2,r0

; 1209 :     va_list arglist;
; 1210 :     WCHAR   szTemp[MAX_PATH];
; 1211 :     size_t  cchLen;
; 1212 :     HRESULT hr;
; 1213 : 
; 1214 :     // Compose a single string using the input args
; 1215 :     va_start(arglist, szFormat);
; 1216 :     hr = StringCchVPrintfW(szTemp, MAX_PATH, szFormat, arglist);

  00012	a806		 add         r0,sp,#0x18
  00014	ab8d		 add         r3,sp,#0x234
  00016	f44f 7182	 mov         r1,#0x104
  0001a	928c		 str         r2,[sp,#0x230]
  0001c	f000 f800	 bl          StringCchVPrintfW

; 1217 :     if (SUCCEEDED(hr)) {

  00020	2800		 cmp         r0,#0
  00022	db17		 blt         |$LN1@CeLogMsg|

; 1218 :         hr = StringCchLengthW(szTemp, MAX_PATH, &cchLen);

  00024	aa04		 add         r2,sp,#0x10
  00026	a806		 add         r0,sp,#0x18
  00028	f44f 7182	 mov         r1,#0x104
  0002c	f000 f800	 bl          StringCchLengthW

; 1219 :         if (SUCCEEDED(hr)) {

  00030	2800		 cmp         r0,#0
  00032	db0f		 blt         |$LN1@CeLogMsg|

; 1220 :             CeLogData(TRUE, CELID_RAW_WCHAR, szTemp, (WORD)((cchLen + 1) * sizeof(WCHAR)),
; 1221 :                       0, CELZONE_ALWAYSON, 0, FALSE);

  00034	f04f 4380	 mov         r3,#0x40000000
  00038	9301		 str         r3,[sp,#4]
  0003a	9b04		 ldr         r3,[sp,#0x10]
  0003c	2200		 movs        r2,#0
  0003e	9203		 str         r2,[sp,#0xC]
  00040	3301		 adds        r3,#1
  00042	005b		 lsls        r3,r3,#1
  00044	9202		 str         r2,[sp,#8]
  00046	9200		 str         r2,[sp]
  00048	aa06		 add         r2,sp,#0x18
  0004a	214a		 movs        r1,#0x4A
  0004c	b29b		 uxth        r3,r3
  0004e	2001		 movs        r0,#1
  00050	f000 f800	 bl          CeLogData
  00054		 |$LN1@CeLogMsg|
  00054		 |$M9|

; 1222 :         }
; 1223 :     }
; 1224 : }

  00054	f20d 2d24	 addw        sp,sp,#0x224
  00058	f000 f800	 bl          __security_pop_cookie
  0005c	f85d bb04	 pop         {r11}
  00060	f85d fb14	 ldr         pc,[sp],#0x14
  00064		 |$M7|

			 ENDP  ; |CeLogMsg|

	EXPORT	|??_C@_1CO@IGCJGAON@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAh?$AAa?$AAn?$AAd?$AAl?$AAe?$AA?5?$AAi?$AAs?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?$AN?$AA?6?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1DC@PBMANACI@?$AAP?$AAm?$AAS?$AAt?$AAo?$AAp?$AAP?$AAo?$AAw?$AAe?$AAr?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1DE@EDKKHCHC@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AAs?$AAt?$AAa?$AAt?$AAu?$AAs?$AA?5?$AA?$CF?$AAd?$AA?$AN?$AA?6?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|PmStopPowerNotifications|
	IMPORT	|gpPowerNotifications|
	IMPORT	|dpCurSettings|
	IMPORT	|PmLock|
	IMPORT	|PowerNotificationRemList|
	IMPORT	|PmUnlock|

  00000			 AREA	 |.pdata|, PDATA
|$pdata1$PmStopPowerNotifications| DCD imagerel |$LN14@PmStopPowe|
	DCD	0xfd3260dd

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1DE@EDKKHCHC@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AAs?$AAt?$AAa?$AAt?$AAu?$AAs?$AA?5?$AA?$CF?$AAd?$AA?$AN?$AA?6?$AA?$AA@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "r", 0x0, "e", 0x0, "t"
	DCB	0x0, "u", 0x0, "r", 0x0, "n", 0x0, "i", 0x0, "n", 0x0, "g"
	DCB	0x0, " ", 0x0, "s", 0x0, "t", 0x0, "a", 0x0, "t", 0x0, "u"
	DCB	0x0, "s", 0x0, " ", 0x0, "%", 0x0, "d", 0x0, 0xd, 0x0, 0xa
	DCB	0x0, 0x0, 0x0				; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1DC@PBMANACI@?$AAP?$AAm?$AAS?$AAt?$AAo?$AAp?$AAP?$AAo?$AAw?$AAe?$AAr?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@| DCB "P"
	DCB	0x0, "m", 0x0, "S", 0x0, "t", 0x0, "o", 0x0, "p", 0x0, "P"
	DCB	0x0, "o", 0x0, "w", 0x0, "e", 0x0, "r", 0x0, "N", 0x0, "o"
	DCB	0x0, "t", 0x0, "i", 0x0, "f", 0x0, "i", 0x0, "c", 0x0, "a"
	DCB	0x0, "t", 0x0, "i", 0x0, "o", 0x0, "n", 0x0, "s", 0x0, 0x0
	DCB	0x0					; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1CO@IGCJGAON@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAh?$AAa?$AAn?$AAd?$AAl?$AAe?$AA?5?$AAi?$AAs?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?$AN?$AA?6?$AA?$AA@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "h", 0x0, "a", 0x0, "n"
	DCB	0x0, "d", 0x0, "l", 0x0, "e", 0x0, " ", 0x0, "i", 0x0, "s"
	DCB	0x0, " ", 0x0, "0", 0x0, "x", 0x0, "%", 0x0, "0", 0x0, "8"
	DCB	0x0, "x", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0 ; `string'
; Function compile flags: /Ogsp
; File c:\wince800\platform\rrm_ppc_windows\src\drivers\pm\mdd\pmnotify.cpp

  00000			 AREA	 |.text|, CODE, THUMB

  00000		 |PmStopPowerNotifications| PROC

; 174  : {

  00000		 |$LN14@PmStopPowe|
  00000	e92d 4878	 push        {r3-r6,r11,lr}
  00004	f20d 0b10	 addw        r11,sp,#0x10
  00008		 |$M12|

; 175  :     DWORD dwStatus = ERROR_INVALID_PARAMETER;
; 176  :     PPOWER_NOTIFICATION ppn = (PPOWER_NOTIFICATION) h;
; 177  :     SETFNAME(_T("PmStopPowerNotifications"));
; 178  : 
; 179  :     PMLOGMSG(ZONE_NOTIFY || ZONE_API, (_T("%s: handle is 0x%08x\r\n"), pszFname, h));

  00008	4e1d		 ldr         r6,|$LN21@PmStopPowe| ; =|dpCurSettings|
  0000a	2457		 movs        r4,#0x57
  0000c	4605		 mov         r5,r0
  0000e	f8d6 3440	 ldr         r3,[r6,#0x440]
  00012	f413 7f80	 tst         r3,#0x100
  00016	d102		 bne         |$LN6@PmStopPowe|
  00018	f413 6f00	 tst         r3,#0x800
  0001c	d006		 beq         |$LN7@PmStopPowe|
  0001e		 |$LN6@PmStopPowe|
  0001e	4817		 ldr         r0,|$LN20@PmStopPowe| ; =|??_C@_1CO@IGCJGAON@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAh?$AAa?$AAn?$AAd?$AAl?$AAe?$AA?5?$AAi?$AAs?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?$AN?$AA?6?$AA?$AA@|
  00020	4913		 ldr         r1,|$LN17@PmStopPowe| ; =|??_C@_1DC@PBMANACI@?$AAP?$AAm?$AAS?$AAt?$AAo?$AAp?$AAP?$AAo?$AAw?$AAe?$AAr?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@|
  00022	462a		 mov         r2,r5
  00024	f000 f800	 bl          CeLogMsg
  00028	f8d6 3440	 ldr         r3,[r6,#0x440]
  0002c		 |$LN7@PmStopPowe|

; 180  :     if(ppn != NULL) {

  0002c	b16d		 cbz         r5,|$LN3@PmStopPowe|

; 181  :         PMLOCK();

  0002e	f000 f800	 bl          PmLock

; 182  :         BOOL fFound = PowerNotificationRemList(&gpPowerNotifications, ppn);

  00032	4811		 ldr         r0,|$LN19@PmStopPowe| ; =|gpPowerNotifications|
  00034	4629		 mov         r1,r5
  00036	f000 f800	 bl          PowerNotificationRemList

; 183  :         if(fFound) {

  0003a	b108		 cbz         r0,|$LN2@PmStopPowe|

; 184  :             dwStatus = ERROR_SUCCESS;

  0003c	2400		 movs        r4,#0

; 185  :         } else {

  0003e	e000		 b           |$LN1@PmStopPowe|
  00040		 |$LN2@PmStopPowe|

; 186  :             dwStatus = ERROR_FILE_NOT_FOUND;

  00040	2402		 movs        r4,#2
  00042		 |$LN1@PmStopPowe|

; 187  :         }
; 188  :         PMUNLOCK();

  00042	f000 f800	 bl          PmUnlock
  00046	f8d6 3440	 ldr         r3,[r6,#0x440]
  0004a		 |$LN3@PmStopPowe|

; 189  :     }
; 190  : 
; 191  :     PMLOGMSG(ZONE_NOTIFY || ZONE_API || (dwStatus != ERROR_SUCCESS && ZONE_WARN),
; 192  :         (_T("%s: returning status %d\r\n"), pszFname, dwStatus));

  0004a	f413 7f80	 tst         r3,#0x100
  0004e	d106		 bne         |$LN8@PmStopPowe|
  00050	f413 6f00	 tst         r3,#0x800
  00054	d103		 bne         |$LN8@PmStopPowe|
  00056	b13c		 cbz         r4,|$LN10@PmStopPowe|
  00058	f013 0f02	 tst         r3,#2
  0005c	d004		 beq         |$LN10@PmStopPowe|
  0005e		 |$LN8@PmStopPowe|
  0005e	4805		 ldr         r0,|$LN18@PmStopPowe| ; =|??_C@_1DE@EDKKHCHC@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AAs?$AAt?$AAa?$AAt?$AAu?$AAs?$AA?5?$AA?$CF?$AAd?$AA?$AN?$AA?6?$AA?$AA@|
  00060	4903		 ldr         r1,|$LN17@PmStopPowe| ; =|??_C@_1DC@PBMANACI@?$AAP?$AAm?$AAS?$AAt?$AAo?$AAp?$AAP?$AAo?$AAw?$AAe?$AAr?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@|
  00062	4622		 mov         r2,r4
  00064	f000 f800	 bl          CeLogMsg
  00068		 |$LN10@PmStopPowe|

; 193  :     return dwStatus;
; 194  : }

  00068	4620		 mov         r0,r4
  0006a		 |$M15|
  0006a	e8bd 8878	 pop         {r3-r6,r11,pc}
  0006e		 |$LN22@PmStopPowe|
  0006e		 |$M23|
  0006e	defe		 __debugbreak
  00070		 |$LN16@PmStopPowe|
  00070		 |$LN17@PmStopPowe|
  00070	0000 0000	 DCD         |??_C@_1DC@PBMANACI@?$AAP?$AAm?$AAS?$AAt?$AAo?$AAp?$AAP?$AAo?$AAw?$AAe?$AAr?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@|
  00074		 |$LN18@PmStopPowe|
  00074	0000 0000	 DCD         |??_C@_1DE@EDKKHCHC@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AAs?$AAt?$AAa?$AAt?$AAu?$AAs?$AA?5?$AA?$CF?$AAd?$AA?$AN?$AA?6?$AA?$AA@|
  00078		 |$LN19@PmStopPowe|
  00078	0000 0000	 DCD         |gpPowerNotifications|
  0007c		 |$LN20@PmStopPowe|
  0007c	0000 0000	 DCD         |??_C@_1CO@IGCJGAON@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAh?$AAa?$AAn?$AAd?$AAl?$AAe?$AA?5?$AAi?$AAs?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?$AN?$AA?6?$AA?$AA@|
  00080		 |$LN21@PmStopPowe|
  00080	0000 0000	 DCD         |dpCurSettings|
  00084		 |$M13|

			 ENDP  ; |PmStopPowerNotifications|

	EXPORT	|??_C@_1GG@MEFCMPGO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAc?$AAr?$AAe?$AAa?$AAt?$AAi?$AAn?$AAg?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?5?$AA0@| [ DATA ] ; `string'
	EXPORT	|??_C@_1DI@PCFPIELD@?$AAP?$AAm?$AAR?$AAe?$AAq?$AAu?$AAe?$AAs?$AAt?$AAP?$AAo?$AAw?$AAe?$AAr?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1EE@LLHHOOMD@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?0?$AA?5?$AAs?$AAt?$AAa?$AAt?$AAu?$AAs?$AA?5?$AA?$CF?$AAd?$AA?$AN@| [ DATA ] ; `string'
	EXPORT	|PmRequestPowerNotifications|
	IMPORT	|GetCallerVMProcessId|
	IMPORT	|PowerNotificationCreate|
	IMPORT	|PowerNotificationAddList|
	IMPORT	|PlatformSendInitialNotifications|
	IMPORT	|GetLastError|
	IMPORT	|SetLastError|

  00000			 AREA	 |.pdata|, PDATA
|$pdata1$PmRequestPowerNotifications| DCD imagerel |$LN18@PmRequestP|
	DCD	0x356145

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1EE@LLHHOOMD@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?0?$AA?5?$AAs?$AAt?$AAa?$AAt?$AAu?$AAs?$AA?5?$AA?$CF?$AAd?$AA?$AN@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "r", 0x0, "e", 0x0, "t"
	DCB	0x0, "u", 0x0, "r", 0x0, "n", 0x0, "i", 0x0, "n", 0x0, "g"
	DCB	0x0, " ", 0x0, "0", 0x0, "x", 0x0, "%", 0x0, "0", 0x0, "8"
	DCB	0x0, "x", 0x0, ",", 0x0, " ", 0x0, "s", 0x0, "t", 0x0, "a"
	DCB	0x0, "t", 0x0, "u", 0x0, "s", 0x0, " ", 0x0, "%", 0x0, "d"
	DCB	0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0	; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1DI@PCFPIELD@?$AAP?$AAm?$AAR?$AAe?$AAq?$AAu?$AAe?$AAs?$AAt?$AAP?$AAo?$AAw?$AAe?$AAr?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@| DCB "P"
	DCB	0x0, "m", 0x0, "R", 0x0, "e", 0x0, "q", 0x0, "u", 0x0, "e"
	DCB	0x0, "s", 0x0, "t", 0x0, "P", 0x0, "o", 0x0, "w", 0x0, "e"
	DCB	0x0, "r", 0x0, "N", 0x0, "o", 0x0, "t", 0x0, "i", 0x0, "f"
	DCB	0x0, "i", 0x0, "c", 0x0, "a", 0x0, "t", 0x0, "i", 0x0, "o"
	DCB	0x0, "n", 0x0, "s", 0x0, 0x0, 0x0	; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1GG@MEFCMPGO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAc?$AAr?$AAe?$AAa?$AAt?$AAi?$AAn?$AAg?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?5?$AA0@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "c", 0x0, "r", 0x0, "e"
	DCB	0x0, "a", 0x0, "t", 0x0, "i", 0x0, "n", 0x0, "g", 0x0, " "
	DCB	0x0, "n", 0x0, "o", 0x0, "t", 0x0, "i", 0x0, "f", 0x0, "i"
	DCB	0x0, "c", 0x0, "a", 0x0, "t", 0x0, "i", 0x0, "o", 0x0, "n"
	DCB	0x0, " ", 0x0, "t", 0x0, "y", 0x0, "p", 0x0, "e", 0x0, " "
	DCB	0x0, "0", 0x0, "x", 0x0, "%", 0x0, "0", 0x0, "8", 0x0, "x"
	DCB	0x0, " ", 0x0, "f", 0x0, "o", 0x0, "r", 0x0, " ", 0x0, "0"
	DCB	0x0, "x", 0x0, "%", 0x0, "0", 0x0, "8", 0x0, "x", 0x0, 0xd
	DCB	0x0, 0xa, 0x0, 0x0, 0x0			; `string'
; Function compile flags: /Ogsp
; File c:\wince800\platform\rrm_ppc_windows\src\drivers\pm\mdd\pmnotify.cpp

  00000			 AREA	 |.text|, CODE, THUMB

  00000		 |PmRequestPowerNotifications| PROC

; 125  : {

  00000		 |$LN18@PmRequestP|
  00000	e92d 4bf0	 push        {r4-r9,r11,lr}
  00004	f20d 0b18	 addw        r11,sp,#0x18
  00008		 |$M16|
  00008	460e		 mov         r6,r1
  0000a	4680		 mov         r8,r0

; 126  :     HANDLE hOwner = (HANDLE) GetCallerVMProcessId();

  0000c	f000 f800	 bl          GetCallerVMProcessId

; 127  :     DWORD dwStatus = ERROR_SUCCESS;
; 128  :     PPOWER_NOTIFICATION ppn = NULL;
; 129  :     SETFNAME(_T("PmRequestPowerNotifications"));
; 130  : 
; 131  :     PMLOGMSG(ZONE_NOTIFY || ZONE_API, 
; 132  :         (_T("%s: creating notification type 0x%08x for 0x%08x\r\n"),
; 133  :         pszFname, dwFlags, hOwner));

  00010	4f28		 ldr         r7,|$LN25@PmRequestP| ; =|dpCurSettings|
  00012	2400		 movs        r4,#0
  00014	2500		 movs        r5,#0
  00016	f8d7 3440	 ldr         r3,[r7,#0x440]
  0001a	4681		 mov         r9,r0
  0001c	f413 7f80	 tst         r3,#0x100
  00020	d102		 bne         |$LN8@PmRequestP|
  00022	f413 6f00	 tst         r3,#0x800
  00026	d007		 beq         |$LN9@PmRequestP|
  00028		 |$LN8@PmRequestP|
  00028	4821		 ldr         r0,|$LN24@PmRequestP| ; =|??_C@_1GG@MEFCMPGO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAc?$AAr?$AAe?$AAa?$AAt?$AAi?$AAn?$AAg?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?5?$AA0@|
  0002a	491e		 ldr         r1,|$LN21@PmRequestP| ; =|??_C@_1DI@PCFPIELD@?$AAP?$AAm?$AAR?$AAe?$AAq?$AAu?$AAe?$AAs?$AAt?$AAP?$AAo?$AAw?$AAe?$AAr?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@|
  0002c	464b		 mov         r3,r9
  0002e	4632		 mov         r2,r6
  00030	f000 f800	 bl          CeLogMsg
  00034	f8d7 3440	 ldr         r3,[r7,#0x440]
  00038		 |$LN9@PmRequestP|

; 134  : 
; 135  :     // check parameters
; 136  :     if(hMsgQ == NULL || dwFlags == 0) {

  00038	f1b8 0f00	 cmp         r8,#0
  0003c	d01a		 beq         |$LN4@PmRequestP|
  0003e	b1ce		 cbz         r6,|$LN4@PmRequestP|

; 138  :     }
; 139  : 
; 140  :     // create the structure if parameters are all right
; 141  :     if(dwStatus == ERROR_SUCCESS) {
; 142  :         ppn = PowerNotificationCreate(hMsgQ, hOwner);

  00040	4649		 mov         r1,r9
  00042	4640		 mov         r0,r8
  00044	f000 f800	 bl          PowerNotificationCreate
  00048	4605		 mov         r5,r0

; 143  :         if(ppn != NULL) {

  0004a	b17d		 cbz         r5,|$LN2@PmRequestP|

; 144  :             ppn->dwFlags = dwFlags;

  0004c	606e		 str         r6,[r5,#4]

; 145  : 
; 146  :             PMLOCK();

  0004e	f000 f800	 bl          PmLock

; 147  :             // add the notification structure to the list
; 148  :             PowerNotificationAddList(&gpPowerNotifications, ppn);

  00052	4816		 ldr         r0,|$LN23@PmRequestP| ; =|gpPowerNotifications|
  00054	4629		 mov         r1,r5
  00056	f000 f800	 bl          PowerNotificationAddList

; 149  : 
; 150  :             // if the notification requires any platform-specific action,
; 151  :             // the platform can do it now
; 152  :             PlatformSendInitialNotifications(ppn, dwFlags);

  0005a	4631		 mov         r1,r6
  0005c	4628		 mov         r0,r5
  0005e	f000 f800	 bl          PlatformSendInitialNotifications

; 153  :             PMUNLOCK();

  00062	f000 f800	 bl          PmUnlock
  00066		 |$LN14@PmRequestP|

; 154  :         } else {

  00066	f8d7 3440	 ldr         r3,[r7,#0x440]
  0006a	e004		 b           |$LN1@PmRequestP|
  0006c		 |$LN2@PmRequestP|

; 155  :             dwStatus = GetLastError();  // set by whatever failed in PowerNotificationCreate()

  0006c	f000 f800	 bl          GetLastError
  00070	4604		 mov         r4,r0
  00072	e7f8		 b           |$LN14@PmRequestP|
  00074		 |$LN4@PmRequestP|

; 137  :         dwStatus = ERROR_INVALID_PARAMETER;

  00074	2457		 movs        r4,#0x57
  00076		 |$LN1@PmRequestP|

; 156  :             DEBUGCHK(dwStatus != ERROR_SUCCESS);
; 157  :         }
; 158  :     }
; 159  : 
; 160  :     PMLOGMSG(ZONE_NOTIFY || ZONE_API || (dwStatus != ERROR_SUCCESS && ZONE_WARN),
; 161  :         (_T("%s: returning 0x%08x, status %d\r\n"), pszFname,
; 162  :         ppn, dwStatus));

  00076	f413 7f80	 tst         r3,#0x100
  0007a	d106		 bne         |$LN10@PmRequestP|
  0007c	f413 6f00	 tst         r3,#0x800
  00080	d103		 bne         |$LN10@PmRequestP|
  00082	b144		 cbz         r4,|$LN12@PmRequestP|
  00084	f013 0f02	 tst         r3,#2
  00088	d005		 beq         |$LN12@PmRequestP|
  0008a		 |$LN10@PmRequestP|
  0008a	4807		 ldr         r0,|$LN22@PmRequestP| ; =|??_C@_1EE@LLHHOOMD@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?0?$AA?5?$AAs?$AAt?$AAa?$AAt?$AAu?$AAs?$AA?5?$AA?$CF?$AAd?$AA?$AN@|
  0008c	4905		 ldr         r1,|$LN21@PmRequestP| ; =|??_C@_1DI@PCFPIELD@?$AAP?$AAm?$AAR?$AAe?$AAq?$AAu?$AAe?$AAs?$AAt?$AAP?$AAo?$AAw?$AAe?$AAr?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@|
  0008e	4623		 mov         r3,r4
  00090	462a		 mov         r2,r5
  00092	f000 f800	 bl          CeLogMsg
  00096		 |$LN12@PmRequestP|

; 163  :     SetLastError(dwStatus);

  00096	4620		 mov         r0,r4
  00098	f000 f800	 bl          SetLastError

; 164  :     return ppn;
; 165  : }

  0009c	4628		 mov         r0,r5
  0009e		 |$M19|
  0009e	e8bd 8bf0	 pop         {r4-r9,r11,pc}
  000a2		 |$LN26@PmRequestP|
  000a2		 |$M27|
  000a2	defe		 __debugbreak
  000a4		 |$LN20@PmRequestP|
  000a4		 |$LN21@PmRequestP|
  000a4	0000 0000	 DCD         |??_C@_1DI@PCFPIELD@?$AAP?$AAm?$AAR?$AAe?$AAq?$AAu?$AAe?$AAs?$AAt?$AAP?$AAo?$AAw?$AAe?$AAr?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@|
  000a8		 |$LN22@PmRequestP|
  000a8	0000 0000	 DCD         |??_C@_1EE@LLHHOOMD@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAr?$AAe?$AAt?$AAu?$AAr?$AAn?$AAi?$AAn?$AAg?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?0?$AA?5?$AAs?$AAt?$AAa?$AAt?$AAu?$AAs?$AA?5?$AA?$CF?$AAd?$AA?$AN@|
  000ac		 |$LN23@PmRequestP|
  000ac	0000 0000	 DCD         |gpPowerNotifications|
  000b0		 |$LN24@PmRequestP|
  000b0	0000 0000	 DCD         |??_C@_1GG@MEFCMPGO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAc?$AAr?$AAe?$AAa?$AAt?$AAi?$AAn?$AAg?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?5?$AA0@|
  000b4		 |$LN25@PmRequestP|
  000b4	0000 0000	 DCD         |dpCurSettings|
  000b8		 |$M17|

			 ENDP  ; |PmRequestPowerNotifications|

	EXPORT	|??_C@_1EG@OGLFPMCD@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAd?$AAe?$AAl?$AAe?$AAt?$AAi?$AAn?$AAg?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx@| [ DATA ] ; `string'
	EXPORT	|??_C@_1DG@KHNJBFOM@?$AAD?$AAe?$AAl?$AAe?$AAt?$AAe?$AAP?$AAr?$AAo?$AAc?$AAe?$AAs?$AAs?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|DeleteProcessNotifications|

  00000			 AREA	 |.pdata|, PDATA
|$pdata1$DeleteProcessNotifications| DCD imagerel |$LN23@DeleteProc|
	DCD	0xfd3460a5

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1DG@KHNJBFOM@?$AAD?$AAe?$AAl?$AAe?$AAt?$AAe?$AAP?$AAr?$AAo?$AAc?$AAe?$AAs?$AAs?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@| DCB "D"
	DCB	0x0, "e", 0x0, "l", 0x0, "e", 0x0, "t", 0x0, "e", 0x0, "P"
	DCB	0x0, "r", 0x0, "o", 0x0, "c", 0x0, "e", 0x0, "s", 0x0, "s"
	DCB	0x0, "N", 0x0, "o", 0x0, "t", 0x0, "i", 0x0, "f", 0x0, "i"
	DCB	0x0, "c", 0x0, "a", 0x0, "t", 0x0, "i", 0x0, "o", 0x0, "n"
	DCB	0x0, "s", 0x0, 0x0, 0x0			; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1EG@OGLFPMCD@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAd?$AAe?$AAl?$AAe?$AAt?$AAi?$AAn?$AAg?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "d", 0x0, "e", 0x0, "l"
	DCB	0x0, "e", 0x0, "t", 0x0, "i", 0x0, "n", 0x0, "g", 0x0, " "
	DCB	0x0, "n", 0x0, "o", 0x0, "t", 0x0, "i", 0x0, "f", 0x0, "i"
	DCB	0x0, "c", 0x0, "a", 0x0, "t", 0x0, "i", 0x0, "o", 0x0, "n"
	DCB	0x0, " ", 0x0, "0", 0x0, "x", 0x0, "%", 0x0, "0", 0x0, "8"
	DCB	0x0, "x", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0 ; `string'
; Function compile flags: /Ogsp
; File c:\wince800\platform\rrm_ppc_windows\src\drivers\pm\mdd\pmnotify.cpp

  00000			 AREA	 |.text|, CODE, THUMB

  00000		 |DeleteProcessNotifications| PROC

; 86   : {

  00000		 |$LN23@DeleteProc|
  00000	e92d 49f8	 push        {r3-r8,r11,lr}
  00004	f20d 0b18	 addw        r11,sp,#0x18
  00008		 |$M21|
  00008	4607		 mov         r7,r0

; 87   :     BOOL fDone = FALSE;

  0000a	2500		 movs        r5,#0

; 88   :     SETFNAME(_T("DeleteProcessNotifications"));
; 89   : 
; 90   :     PMLOCK();

  0000c	f000 f800	 bl          PmLock
  00010	f8df 804c	 ldr         r8,|$LN29@DeleteProc| ; =|dpCurSettings|
  00014	4e11		 ldr         r6,|$LN28@DeleteProc| ; =|gpPowerNotifications|
  00016		 |$LL7@DeleteProc|
  00016	6834		 ldr         r4,[r6]
  00018	e003		 b           |$LN19@DeleteProc|
  0001a		 |$LL5@DeleteProc|

; 98   :             if(ppn->hOwner == hProcess) {

  0001a	68a3		 ldr         r3,[r4,#8]
  0001c	42bb		 cmp         r3,r7
  0001e	d009		 beq         |$LN14@DeleteProc|

; 96   :         PPOWER_NOTIFICATION ppn;
; 97   :         for(ppn = gpPowerNotifications; ppn != NULL; ppn = ppn->pNext) {

  00020	68e4		 ldr         r4,[r4,#0xC]
  00022		 |$LN19@DeleteProc|
  00022	2c00		 cmp         r4,#0
  00024	d1f9		 bne         |$LL5@DeleteProc|

; 108  :             // yes, no need to re-iterate
; 109  :             fDone = TRUE;

  00026	2501		 movs        r5,#1
  00028		 |$LN1@DeleteProc|

; 91   : 
; 92   :     // remove all notifications belonging to this process.  If we
; 93   :     // remove one from the list, start again -- we will eventually run
; 94   :     // out of notifications for this process.
; 95   :     while(!fDone) {

  00028	2d00		 cmp         r5,#0
  0002a	d0f4		 beq         |$LL7@DeleteProc|

; 110  :         }
; 111  :     }
; 112  : 
; 113  :     PMUNLOCK();

  0002c	f000 f800	 bl          PmUnlock
  00030		 |$M24|

; 114  : }

  00030	e8bd 89f8	 pop         {r3-r8,r11,pc}
  00034		 |$LN14@DeleteProc|

; 99   :                 PMLOGMSG(ZONE_NOTIFY, (_T("%s: deleting notification 0x%08x\r\n"),
; 100  :                     pszFname, ppn));

  00034	f8d8 3440	 ldr         r3,[r8,#0x440]
  00038	f413 7f80	 tst         r3,#0x100
  0003c	d004		 beq         |$LN10@DeleteProc|
  0003e	4906		 ldr         r1,|$LN27@DeleteProc| ; =|??_C@_1DG@KHNJBFOM@?$AAD?$AAe?$AAl?$AAe?$AAt?$AAe?$AAP?$AAr?$AAo?$AAc?$AAe?$AAs?$AAs?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@|
  00040	4804		 ldr         r0,|$LN26@DeleteProc| ; =|??_C@_1EG@OGLFPMCD@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAd?$AAe?$AAl?$AAe?$AAt?$AAi?$AAn?$AAg?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx@|
  00042	4622		 mov         r2,r4
  00044	f000 f800	 bl          CeLogMsg
  00048		 |$LN10@DeleteProc|

; 101  :                 PowerNotificationRemList(&gpPowerNotifications, ppn);

  00048	4621		 mov         r1,r4
  0004a	4630		 mov         r0,r6
  0004c	f000 f800	 bl          PowerNotificationRemList

; 102  :                 break;
; 103  :             }
; 104  :         }
; 105  : 
; 106  :         // did we get through the whole list?
; 107  :         if(ppn == NULL) {

  00050	e7ea		 b           |$LN1@DeleteProc|
  00052		 |$LN30@DeleteProc|
  00052		 |$M31|
  00052	defe		 __debugbreak
  00054		 |$LN25@DeleteProc|
  00054		 |$LN26@DeleteProc|
  00054	0000 0000	 DCD         |??_C@_1EG@OGLFPMCD@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAd?$AAe?$AAl?$AAe?$AAt?$AAi?$AAn?$AAg?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx@|
  00058		 |$LN27@DeleteProc|
  00058	0000 0000	 DCD         |??_C@_1DG@KHNJBFOM@?$AAD?$AAe?$AAl?$AAe?$AAt?$AAe?$AAP?$AAr?$AAo?$AAc?$AAe?$AAs?$AAs?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@|
  0005c		 |$LN28@DeleteProc|
  0005c	0000 0000	 DCD         |gpPowerNotifications|
  00060		 |$LN29@DeleteProc|
  00060	0000 0000	 DCD         |dpCurSettings|
  00064		 |$M22|

			 ENDP  ; |DeleteProcessNotifications|

	EXPORT	|??_C@_1GI@KNKFKCIB@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAs?$AAe?$AAn?$AAd?$AAi?$AAn?$AAg?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?5?$AAt?$AAo?$AA?5?$AA0?$AAx?$AA?$CF?$AA0@| [ DATA ] ; `string'
	EXPORT	|??_C@_1CC@BDENJPOO@?$AAS?$AAe?$AAn?$AAd?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1GI@DENKDPBO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAW?$AAr?$AAi?$AAt?$AAe?$AAM?$AAs?$AAg?$AAQ?$AAu?$AAe?$AAu?$AAe?$AA?$CI?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?0?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx@| [ DATA ] ; `string'
	EXPORT	|SendNotification|
	IMPORT	|WriteMsgQueue|

  00000			 AREA	 |.pdata|, PDATA
|$pdata1$SendNotification| DCD imagerel |$LN11@SendNotifi|
	DCD	0xfd7360b1

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1GI@DENKDPBO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAW?$AAr?$AAi?$AAt?$AAe?$AAM?$AAs?$AAg?$AAQ?$AAu?$AAe?$AAu?$AAe?$AA?$CI?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?0?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "W", 0x0, "r", 0x0, "i"
	DCB	0x0, "t", 0x0, "e", 0x0, "M", 0x0, "s", 0x0, "g", 0x0, "Q"
	DCB	0x0, "u", 0x0, "e", 0x0, "u", 0x0, "e", 0x0, "(", 0x0, "0"
	DCB	0x0, "x", 0x0, "%", 0x0, "0", 0x0, "8", 0x0, "x", 0x0, ","
	DCB	0x0, " ", 0x0, "0", 0x0, "x", 0x0, "%", 0x0, "0", 0x0, "8"
	DCB	0x0, "x", 0x0, ",", 0x0, " ", 0x0, "0", 0x0, "x", 0x0, "%"
	DCB	0x0, "x", 0x0, ")", 0x0, " ", 0x0, "f", 0x0, "a", 0x0, "i"
	DCB	0x0, "l", 0x0, "e", 0x0, "d", 0x0, " ", 0x0, "%", 0x0, "d"
	DCB	0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0	; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1CC@BDENJPOO@?$AAS?$AAe?$AAn?$AAd?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?$AA@| DCB "S"
	DCB	0x0, "e", 0x0, "n", 0x0, "d", 0x0, "N", 0x0, "o", 0x0, "t"
	DCB	0x0, "i", 0x0, "f", 0x0, "i", 0x0, "c", 0x0, "a", 0x0, "t"
	DCB	0x0, "i", 0x0, "o", 0x0, "n", 0x0, 0x0, 0x0 ; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1GI@KNKFKCIB@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAs?$AAe?$AAn?$AAd?$AAi?$AAn?$AAg?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?5?$AAt?$AAo?$AA?5?$AA0?$AAx?$AA?$CF?$AA0@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "s", 0x0, "e", 0x0, "n"
	DCB	0x0, "d", 0x0, "i", 0x0, "n", 0x0, "g", 0x0, " ", 0x0, "n"
	DCB	0x0, "o", 0x0, "t", 0x0, "i", 0x0, "f", 0x0, "i", 0x0, "c"
	DCB	0x0, "a", 0x0, "t", 0x0, "i", 0x0, "o", 0x0, "n", 0x0, " "
	DCB	0x0, "t", 0x0, "o", 0x0, " ", 0x0, "0", 0x0, "x", 0x0, "%"
	DCB	0x0, "0", 0x0, "8", 0x0, "x", 0x0, " ", 0x0, "(", 0x0, "o"
	DCB	0x0, "w", 0x0, "n", 0x0, "e", 0x0, "r", 0x0, " ", 0x0, "0"
	DCB	0x0, "x", 0x0, "%", 0x0, "0", 0x0, "8", 0x0, "x", 0x0, ")"
	DCB	0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0	; `string'
; Function compile flags: /Ogsp
; File c:\wince800\platform\rrm_ppc_windows\src\drivers\pm\mdd\pmnotify.cpp

  00000			 AREA	 |.text|, CODE, THUMB

  00000		 |SendNotification| PROC

; 27   : {

  00000		 |$LN11@SendNotifi|
  00000	e92d 48fc	 push        {r2-r7,r11,lr}
  00004	f20d 0b18	 addw        r11,sp,#0x18
  00008		 |$M9|

; 28   :     SETFNAME(_T("SendNotification"));
; 29   : 
; 30   :     PMLOGMSG(ZONE_NOTIFY, 
; 31   :         (_T("%s: sending notification to 0x%08x (owner 0x%08x)\r\n"),
; 32   :         pszFname, ppn, ppn->hOwner));

  00008	4d16		 ldr         r5,|$LN17@SendNotifi| ; =|dpCurSettings|
  0000a	4616		 mov         r6,r2
  0000c	460f		 mov         r7,r1
  0000e	f8d5 3440	 ldr         r3,[r5,#0x440]
  00012	4604		 mov         r4,r0
  00014	f413 7f80	 tst         r3,#0x100
  00018	d005		 beq         |$LN4@SendNotifi|
  0001a	68a3		 ldr         r3,[r4,#8]
  0001c	4810		 ldr         r0,|$LN16@SendNotifi| ; =|??_C@_1GI@KNKFKCIB@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAs?$AAe?$AAn?$AAd?$AAi?$AAn?$AAg?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?5?$AAt?$AAo?$AA?5?$AA0?$AAx?$AA?$CF?$AA0@|
  0001e	490f		 ldr         r1,|$LN15@SendNotifi| ; =|??_C@_1CC@BDENJPOO@?$AAS?$AAe?$AAn?$AAd?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?$AA@|
  00020	4622		 mov         r2,r4
  00022	f000 f800	 bl          CeLogMsg
  00026		 |$LN4@SendNotifi|

; 33   :     if(!WriteMsgQueue(ppn->hMsgQ, ppb, dwLen, 0, 0)) {

  00026	6820		 ldr         r0,[r4]
  00028	2300		 movs        r3,#0
  0002a	4632		 mov         r2,r6
  0002c	4639		 mov         r1,r7
  0002e	9300		 str         r3,[sp]
  00030	f000 f800	 bl          WriteMsgQueue
  00034	b970		 cbnz        r0,|$LN6@SendNotifi|

; 34   :         PMLOGMSG(ZONE_WARN, (_T("%s: WriteMsgQueue(0x%08x, 0x%08x, 0x%x) failed %d\r\n"),
; 35   :             pszFname, ppn->hMsgQ, ppb, dwLen, GetLastError()));

  00036	f8d5 3440	 ldr         r3,[r5,#0x440]
  0003a	f013 0f02	 tst         r3,#2
  0003e	d009		 beq         |$LN6@SendNotifi|
  00040	f000 f800	 bl          GetLastError
  00044	6822		 ldr         r2,[r4]
  00046	4905		 ldr         r1,|$LN15@SendNotifi| ; =|??_C@_1CC@BDENJPOO@?$AAS?$AAe?$AAn?$AAd?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?$AA@|
  00048	9001		 str         r0,[sp,#4]
  0004a	4803		 ldr         r0,|$LN14@SendNotifi| ; =|??_C@_1GI@DENKDPBO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAW?$AAr?$AAi?$AAt?$AAe?$AAM?$AAs?$AAg?$AAQ?$AAu?$AAe?$AAu?$AAe?$AA?$CI?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?0?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx@|
  0004c	463b		 mov         r3,r7
  0004e	9600		 str         r6,[sp]
  00050	f000 f800	 bl          CeLogMsg
  00054		 |$LN6@SendNotifi|
  00054		 |$M12|

; 36   :     }        
; 37   : }

  00054	e8bd 88fc	 pop         {r2-r7,r11,pc}
  00058		 |$LN13@SendNotifi|
  00058		 |$LN14@SendNotifi|
  00058	0000 0000	 DCD         |??_C@_1GI@DENKDPBO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAW?$AAr?$AAi?$AAt?$AAe?$AAM?$AAs?$AAg?$AAQ?$AAu?$AAe?$AAu?$AAe?$AA?$CI?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx?$AA?0?$AA?5?$AA0?$AAx?$AA?$CF?$AA0?$AA8?$AAx@|
  0005c		 |$LN15@SendNotifi|
  0005c	0000 0000	 DCD         |??_C@_1CC@BDENJPOO@?$AAS?$AAe?$AAn?$AAd?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?$AA@|
  00060		 |$LN16@SendNotifi|
  00060	0000 0000	 DCD         |??_C@_1GI@KNKFKCIB@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAs?$AAe?$AAn?$AAd?$AAi?$AAn?$AAg?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AA?5?$AAt?$AAo?$AA?5?$AA0?$AAx?$AA?$CF?$AA0@|
  00064		 |$LN17@SendNotifi|
  00064	0000 0000	 DCD         |dpCurSettings|
  00068		 |$M10|

			 ENDP  ; |SendNotification|

	EXPORT	|??_C@_1FO@BFJEGKNE@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAs?$AAe?$AAn?$AAd?$AAi?$AAn?$AAg?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?5?$AA?$CF?$AAd?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn@| [ DATA ] ; `string'
	EXPORT	|??_C@_1CM@PAJMHOJ@?$AAG?$AAe?$AAn?$AAe?$AAr?$AAa?$AAt?$AAe?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@| [ DATA ] ; `string'
	EXPORT	|??_C@_1FC@IHBDDNIO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAd?$AAo?$AAn?$AAe?$AA?5?$AAs?$AAe?$AAn?$AAd?$AAi?$AAn?$AAg?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?5?$AA?$CF?$AAd?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc@| [ DATA ] ; `string'
	EXPORT	|GenerateNotifications|

  00000			 AREA	 |.pdata|, PDATA
|$pdata1$GenerateNotifications| DCD imagerel |$LN22@GenerateNo|
	DCD	0x1b30121

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1FC@IHBDDNIO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAd?$AAo?$AAn?$AAe?$AA?5?$AAs?$AAe?$AAn?$AAd?$AAi?$AAn?$AAg?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?5?$AA?$CF?$AAd?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "d", 0x0, "o", 0x0, "n"
	DCB	0x0, "e", 0x0, " ", 0x0, "s", 0x0, "e", 0x0, "n", 0x0, "d"
	DCB	0x0, "i", 0x0, "n", 0x0, "g", 0x0, " ", 0x0, "t", 0x0, "y"
	DCB	0x0, "p", 0x0, "e", 0x0, " ", 0x0, "%", 0x0, "d", 0x0, " "
	DCB	0x0, "n", 0x0, "o", 0x0, "t", 0x0, "i", 0x0, "f", 0x0, "i"
	DCB	0x0, "c", 0x0, "a", 0x0, "t", 0x0, "i", 0x0, "o", 0x0, "n"
	DCB	0x0, "s", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0 ; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1CM@PAJMHOJ@?$AAG?$AAe?$AAn?$AAe?$AAr?$AAa?$AAt?$AAe?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@| DCB "G"
	DCB	0x0, "e", 0x0, "n", 0x0, "e", 0x0, "r", 0x0, "a", 0x0, "t"
	DCB	0x0, "e", 0x0, "N", 0x0, "o", 0x0, "t", 0x0, "i", 0x0, "f"
	DCB	0x0, "i", 0x0, "c", 0x0, "a", 0x0, "t", 0x0, "i", 0x0, "o"
	DCB	0x0, "n", 0x0, "s", 0x0, 0x0, 0x0	; `string'

  00000			 AREA	 |.rdata|, DATA, READONLY
|??_C@_1FO@BFJEGKNE@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAs?$AAe?$AAn?$AAd?$AAi?$AAn?$AAg?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?5?$AA?$CF?$AAd?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn@| DCB "%"
	DCB	0x0, "s", 0x0, ":", 0x0, " ", 0x0, "s", 0x0, "e", 0x0, "n"
	DCB	0x0, "d", 0x0, "i", 0x0, "n", 0x0, "g", 0x0, " ", 0x0, "t"
	DCB	0x0, "y", 0x0, "p", 0x0, "e", 0x0, " ", 0x0, "%", 0x0, "d"
	DCB	0x0, " ", 0x0, "n", 0x0, "o", 0x0, "t", 0x0, "i", 0x0, "f"
	DCB	0x0, "i", 0x0, "c", 0x0, "a", 0x0, "t", 0x0, "i", 0x0, "o"
	DCB	0x0, "n", 0x0, "s", 0x0, " ", 0x0, "(", 0x0, "%", 0x0, "d"
	DCB	0x0, " ", 0x0, "b", 0x0, "y", 0x0, "t", 0x0, "e", 0x0, "s"
	DCB	0x0, ")", 0x0, 0xd, 0x0, 0xa, 0x0, 0x0, 0x0 ; `string'
; Function compile flags: /Ogsp
; File c:\wince800\platform\rrm_ppc_windows\src\drivers\pm\mdd\pmnotify.cpp
; File c:\wince800\public\common\oak\inc\pkfuncs.h
; File c:\wince800\platform\rrm_ppc_windows\src\drivers\pm\mdd\pmnotify.cpp

  00000			 AREA	 |.text|, CODE, THUMB

  00000		 |GenerateNotifications| PROC

; 42   : {

  00000		 |$LN22@GenerateNo|
  00000	e92d 48f0	 push        {r4-r7,r11,lr}
  00004	f20d 0b10	 addw        r11,sp,#0x10
  00008	b086		 sub         sp,sp,#0x18
  0000a		 |$M20|
  0000a	4604		 mov         r4,r0

; 43   :     PPOWER_NOTIFICATION ppn;
; 44   :     DWORD dwLen;
; 45   :     SETFNAME(_T("GenerateNotifications"));
; 46   : 
; 47   :     PREFAST_DEBUGCHK(ppb != NULL);
; 48   : 
; 49   :     // Calculate the amount of data to send, since these are variable length
; 50   :     // messages.  Always send at least sizeof(POWER_BROADCAST) bytes so that
; 51   :     // the receiver doesn't have to worry about structure alignment and size
; 52   :     // issues when they receive the message.
; 53   :     dwLen = ppb->Length + (3 * sizeof(DWORD));

  0000c	68a3		 ldr         r3,[r4,#8]
  0000e	f113 060c	 adds        r6,r3,#0xC

; 54   :     if(dwLen < sizeof(POWER_BROADCAST)) {

  00012	2e10		 cmp         r6,#0x10
  00014	d200		 bcs         |$LN6@GenerateNo|

; 55   :         dwLen = sizeof(POWER_BROADCAST);

  00016	2610		 movs        r6,#0x10
  00018		 |$LN6@GenerateNo|

; 56   :     }
; 57   : 
; 58   :     PMLOGMSG(ZONE_NOTIFY, (_T("%s: sending type %d notifications (%d bytes)\r\n"),
; 59   :         pszFname, ppb->Message, dwLen));

  00018	4f21		 ldr         r7,|$LN29@GenerateNo| ; =|dpCurSettings|
  0001a	f8d7 3440	 ldr         r3,[r7,#0x440]
  0001e	f413 7f80	 tst         r3,#0x100
  00022	d005		 beq         |$LN9@GenerateNo|
  00024	6822		 ldr         r2,[r4]
  00026	481d		 ldr         r0,|$LN28@GenerateNo| ; =|??_C@_1FO@BFJEGKNE@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAs?$AAe?$AAn?$AAd?$AAi?$AAn?$AAg?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?5?$AA?$CF?$AAd?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn@|
  00028	4919		 ldr         r1,|$LN25@GenerateNo| ; =|??_C@_1CM@PAJMHOJ@?$AAG?$AAe?$AAn?$AAe?$AAr?$AAa?$AAt?$AAe?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@|
  0002a	4633		 mov         r3,r6
  0002c	f000 f800	 bl          CeLogMsg
  00030		 |$LN9@GenerateNo|

; 60   : 
; 61   : #if (_WINCEOSVER<=700)
; 62   : #else
; 63   :     // user idle event processing
; 64   :     if( (ppb->Message == PBT_TRANSITION) && (ppb->Flags == POWER_STATE_USERIDLE) )

  00030	6823		 ldr         r3,[r4]
  00032	2b01		 cmp         r3,#1
  00034	d10e		 bne         |$LN13@GenerateNo|
  00036	6863		 ldr         r3,[r4,#4]
  00038	f1b3 7f80	 cmp         r3,#0x1000000
  0003c	d10a		 bne         |$LN13@GenerateNo|
; File c:\wince800\public\common\oak\inc\pkfuncs.h

; 1633 :     BOOL fForceCompaction = FALSE;

  0003e	2300		 movs        r3,#0
  00040	9304		 str         r3,[sp,#0x10]

; 1634 :     return KernelLibIoControl ((HANDLE) KMOD_CORE, IOCTL_KLIB_SET_DEVICE_STATE_TO_IDLE, &fForceCompaction, sizeof(fForceCompaction), NULL, 0, 0);    

  00042	9302		 str         r3,[sp,#8]
  00044	9301		 str         r3,[sp,#4]
  00046	9300		 str         r3,[sp]
  00048	2304		 movs        r3,#4
  0004a	aa04		 add         r2,sp,#0x10
  0004c	212c		 movs        r1,#0x2C
  0004e	2001		 movs        r0,#1
  00050	f000 f800	 bl          KernelLibIoControl
  00054		 |$LN13@GenerateNo|
; File c:\wince800\platform\rrm_ppc_windows\src\drivers\pm\mdd\pmnotify.cpp

; 69   :     for(ppn = gpPowerNotifications; ppn != NULL; ppn = ppn->pNext) {

  00054	4b10		 ldr         r3,|$LN27@GenerateNo| ; =|gpPowerNotifications|
  00056	681d		 ldr         r5,[r3]
  00058	e009		 b           |$LN18@GenerateNo|
  0005a		 |$LL4@GenerateNo|

; 70   :         // is this a message type for which the client has registered?
; 71   :         if((ppn->dwFlags & ppb->Message) != 0) {

  0005a	686a		 ldr         r2,[r5,#4]
  0005c	6823		 ldr         r3,[r4]
  0005e	421a		 tst         r2,r3
  00060	d004		 beq         |$LN3@GenerateNo|

; 72   :             // yes, send the message
; 73   :             SendNotification(ppn, ppb, dwLen);

  00062	4632		 mov         r2,r6
  00064	4621		 mov         r1,r4
  00066	4628		 mov         r0,r5
  00068	f000 f800	 bl          SendNotification
  0006c		 |$LN3@GenerateNo|

; 69   :     for(ppn = gpPowerNotifications; ppn != NULL; ppn = ppn->pNext) {

  0006c	68ed		 ldr         r5,[r5,#0xC]
  0006e		 |$LN18@GenerateNo|
  0006e	2d00		 cmp         r5,#0
  00070	d1f3		 bne         |$LL4@GenerateNo|

; 74   :         }
; 75   :     }
; 76   :     PMUNLOCK();

  00072	f000 f800	 bl          PmUnlock

; 77   : 
; 78   :     PMLOGMSG(ZONE_NOTIFY, (_T("%s: done sending type %d notifications\r\n"),
; 79   :         pszFname, ppb->Message));

  00076	f8d7 3440	 ldr         r3,[r7,#0x440]
  0007a	f413 7f80	 tst         r3,#0x100
  0007e	d004		 beq         |$LN11@GenerateNo|
  00080	6822		 ldr         r2,[r4]
  00082	4804		 ldr         r0,|$LN26@GenerateNo| ; =|??_C@_1FC@IHBDDNIO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAd?$AAo?$AAn?$AAe?$AA?5?$AAs?$AAe?$AAn?$AAd?$AAi?$AAn?$AAg?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?5?$AA?$CF?$AAd?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc@|
  00084	4902		 ldr         r1,|$LN25@GenerateNo| ; =|??_C@_1CM@PAJMHOJ@?$AAG?$AAe?$AAn?$AAe?$AAr?$AAa?$AAt?$AAe?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@|
  00086	f000 f800	 bl          CeLogMsg
  0008a		 |$LN11@GenerateNo|
  0008a		 |$M23|

; 80   : }

  0008a	b006		 add         sp,sp,#0x18
  0008c	e8bd 88f0	 pop         {r4-r7,r11,pc}
  00090		 |$LN24@GenerateNo|
  00090		 |$LN25@GenerateNo|
  00090	0000 0000	 DCD         |??_C@_1CM@PAJMHOJ@?$AAG?$AAe?$AAn?$AAe?$AAr?$AAa?$AAt?$AAe?$AAN?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn?$AAs?$AA?$AA@|
  00094		 |$LN26@GenerateNo|
  00094	0000 0000	 DCD         |??_C@_1FC@IHBDDNIO@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAd?$AAo?$AAn?$AAe?$AA?5?$AAs?$AAe?$AAn?$AAd?$AAi?$AAn?$AAg?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?5?$AA?$CF?$AAd?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc@|
  00098		 |$LN27@GenerateNo|
  00098	0000 0000	 DCD         |gpPowerNotifications|
  0009c		 |$LN28@GenerateNo|
  0009c	0000 0000	 DCD         |??_C@_1FO@BFJEGKNE@?$AA?$CF?$AAs?$AA?3?$AA?5?$AAs?$AAe?$AAn?$AAd?$AAi?$AAn?$AAg?$AA?5?$AAt?$AAy?$AAp?$AAe?$AA?5?$AA?$CF?$AAd?$AA?5?$AAn?$AAo?$AAt?$AAi?$AAf?$AAi?$AAc?$AAa?$AAt?$AAi?$AAo?$AAn@|
  000a0		 |$LN29@GenerateNo|
  000a0	0000 0000	 DCD         |dpCurSettings|
  000a4		 |$M21|

			 ENDP  ; |GenerateNotifications|

	END
